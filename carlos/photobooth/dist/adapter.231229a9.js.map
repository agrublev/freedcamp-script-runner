{"version":3,"sources":["../node_modules/webrtc-adapter/out/adapter.js","../../../../../usr/local/lib/node_modules/parcel/src/builtins/hmr-runtime.js"],"names":["f","exports","module","define","amd","g","window","global","self","adapter","r","e","n","t","o","i","c","require","u","a","Error","code","p","call","length","_adapter_factory","adapterFactory","Object","defineProperty","value","_utils","utils","_interopRequireWildcard","_chrome_shim","chromeShim","_edge_shim","edgeShim","_firefox_shim","firefoxShim","_safari_shim","safariShim","_common_shim","commonShim","obj","__esModule","newObj","key","prototype","hasOwnProperty","default","_ref","arguments","undefined","options","shimChrome","shimFirefox","shimEdge","shimSafari","logging","log","browserDetails","detectBrowser","extractVersion","disableLog","disableWarnings","browser","shimPeerConnection","browserShim","shimGetUserMedia","shimMediaStream","shimOnTrack","shimAddTrackRemoveTrack","shimGetSendersWithDtmf","shimGetStats","shimSenderReceiverGetStats","fixNegotiationNeeded","shimRTCIceCandidate","shimConnectionState","shimMaxMessageSize","shimSendThrowTypeError","removeAllowExtmapMixed","shimRemoveStream","shimSenderGetStats","shimReceiverGetStats","shimRTCDataChannel","shimGetDisplayMedia","shimReplaceTrack","shimRTCIceServerUrls","shimCreateOfferLegacy","shimCallbacksAPI","shimLocalStreamsAPI","shimRemoteStreamsAPI","shimTrackEventTransceiver","_typeof","Symbol","iterator","constructor","_getusermedia","enumerable","get","_getdisplaymedia","shimAddTrackRemoveTrackWithNative","MediaStream","webkitMediaStream","RTCPeerConnection","_ontrack","set","removeEventListener","addEventListener","configurable","origSetRemoteDescription","setRemoteDescription","_this","_ontrackpoly","stream","te","receiver","getReceivers","find","track","id","event","Event","transceiver","streams","dispatchEvent","getTracks","forEach","apply","wrapPeerConnectionEvent","shimSenderWithDtmf","pc","dtmf","_dtmf","kind","createDTMFSender","_pc","getSenders","_senders","slice","origAddTrack","addTrack","sender","push","origRemoveTrack","removeTrack","idx","indexOf","splice","origAddStream","addStream","_this2","origRemoveStream","removeStream","_this3","s","RTCRtpSender","origGetSenders","_this4","senders","origGetStats","getStats","selector","successCallback","errorCallback","_this5","args","fixChromeStats_","response","standardReport","reports","result","report","standardStats","timestamp","type","localcandidate","remotecandidate","names","name","stat","makeMapStats","stats","Map","keys","map","successCallbackWrapper_","Promise","resolve","reject","then","RTCRtpReceiver","_this6","filterStats","origGetReceivers","_this7","receivers","srcElement","MediaStreamTrack","err","DOMException","getLocalStreams","_this8","_shimmedLocalStreams","streamId","_this9","alreadyExists","existingSenders","newSenders","filter","newSender","concat","_this10","version","origGetLocalStreams","_this11","nativeStreams","_reverseStreams","_this12","_streams","newStream","_this13","signalingState","oldStream","replaceInternalStreamId","description","sdp","internalId","externalStream","internalStream","replace","RegExp","RTCSessionDescription","replaceExternalStreamId","method","nativeMethod","_this14","isLegacyCall","desc","origSetLocalDescription","setLocalDescription","origLocalDescription","getOwnPropertyDescriptor","_this15","isLocal","streamid","hasTrack","webkitRTCPeerConnection","RTCIceCandidate","nativeAddIceCandidate","addIceCandidate","target","getSourceId","navigator","mediaDevices","console","error","getDisplayMedia","constraints","sourceId","widthSpecified","video","width","heightSpecified","height","frameRateSpecified","frameRate","mandatory","chromeMediaSource","chromeMediaSourceId","maxFrameRate","maxWidth","maxHeight","getUserMedia","constraintsToChrome_","optional","cc","ideal","exact","min","max","oldname_","prefix","charAt","toUpperCase","oc","mix","advanced","shimConstraints_","func","JSON","parse","stringify","audio","remap","b","face","facingMode","getSupportedFacingModeLies","getSupportedConstraints","matches","enumerateDevices","devices","d","dev","some","match","label","toLowerCase","includes","deviceId","shimError_","PermissionDeniedError","PermissionDismissedError","InvalidStateError","DevicesNotFoundError","ConstraintNotSatisfiedError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","TabCaptureError","ScreenCaptureError","DeviceCaptureError","message","constraint","constraintName","toString","getUserMedia_","onSuccess","onError","webkitGetUserMedia","bind","origGetUserMedia","cs","getAudioTracks","getVideoTracks","stop","_sdp","_sdp2","_interopRequireDefault","NativeRTCIceCandidate","candidate","substr","nativeCandidate","parsedCandidate","parseCandidate","augmentedCandidate","assign","toJSON","sdpMid","sdpMLineIndex","usernameFragment","writable","RTCSctpTransport","_sctp","sctpInDescription","sections","splitSections","shift","mediaSection","mLine","parseMLine","protocol","getRemoteFirefoxVersion","parseInt","getCanSendMaxMessageSize","remoteIsFirefox","canSendMaxMessageSize","getMaxMessageSize","maxMessageSize","matchPrefix","isFirefox","canSendMMS","remoteMMS","Number","POSITIVE_INFINITY","Math","sctp","wrapDcSend","dc","origDataChannelSend","send","data","size","byteLength","readyState","TypeError","origCreateDataChannel","createDataChannel","dataChannel","channel","proto","completed","checking","iceConnectionState","_onconnectionstatechange","cb","origMethod","_connectionstatechangepoly","_lastConnectionState","connectionState","newEvent","nativeSRD","split","line","trim","join","_filtericeservers","_rtcpeerconnectionShim","_rtcpeerconnectionShim2","RTCIceGatherer","origMSTEnabled","ev","enabled","RTCDtmfSender","RTCDTMFSender","RTCPeerConnectionShim","config","iceServers","filterIceServers","replaceTrack","setTrack","edgeVersion","hasTurn","server","urls","url","deprecated","isString","validTurn","startsWith","catch","RTCTrackEvent","mozRTCPeerConnection","modernStatsTypes","inboundrtp","outboundrtp","candidatepair","nativeGetStats","onSucc","onErr","DataChannel","RTCDataChannel","preferredMediaSource","mediaSource","nativeGetUserMedia","getSettings","nativeGetSettings","applyConstraints","nativeApplyConstraints","shimConstraints","_localStreams","_addTrack","index","tracks","getRemoteStreams","_remoteStreams","_onaddstream","_onaddstreampoly","createOffer","createAnswer","failureCallback","promise","withCallback","_getUserMedia","errcb","compactObject","OrigPeerConnection","pcConfig","pcConstraints","newIceServers","generateCertificate","RTCTransceiver","origCreateOffer","offerOptions","offerToReceiveAudio","audioTransceiver","getTransceivers","direction","setDirection","addTransceiver","offerToReceiveVideo","videoTransceiver","walkStats","_defineProperty","logDisabled_","deprecationWarnings_","uastring","expr","pos","eventNameToWrap","wrapper","nativeAddEventListener","nativeEventName","wrappedCallback","modifiedEvent","_eventMap","nativeRemoveEventListener","unwrappedCb","bool","oldMethod","newMethod","warn","mozGetUserMedia","userAgent","reduce","accumulator","isObject","isEmptyObject","base","resultSet","has","endsWith","outbound","streamStatsType","filteredResult","trackStats","trackIdentifier","trackStat","trackId","SDPUtils","fixStatsType","writeMediaSection","caps","dtlsRole","writeRtpDescription","writeIceParameters","iceGatherer","getLocalParameters","writeDtlsParameters","dtlsTransport","mid","rtpSender","rtpReceiver","_initialTrackId","msid","sendEncodingParameters","ssrc","rtx","localCName","getCommonCapabilities","localCapabilities","remoteCapabilities","commonCapabilities","codecs","headerExtensions","fecMechanisms","findCodecByPayloadType","pt","payloadType","preferredPayloadType","rtxCapabilityMatches","lRtx","rRtx","lCodecs","rCodecs","lCodec","parameters","apt","rCodec","clockRate","numChannels","rtcpFeedback","fb","j","parameter","lHeaderExtension","rHeaderExtension","uri","isActionAllowedInSignalingState","action","offer","answer","maybeAddCandidate","iceTransport","alreadyAdded","getRemoteCandidates","remoteCandidate","foundation","ip","port","priority","addRemoteCandidate","makeError","NotSupportedError","InvalidAccessError","OperationError","addTrackToStreamAndFireEvent","MediaStreamTrackEvent","removeTrackFromStreamAndFireEvent","fireAddTrack","trackEvent","setTimeout","_dispatchEvent","_eventTarget","document","createDocumentFragment","canTrickleIceCandidates","needNegotiation","localStreams","remoteStreams","_localDescription","_remoteDescription","iceGatheringState","usingBundle","bundlePolicy","rtcpMuxPolicy","iceTransportPolicy","_iceGatherers","iceCandidatePoolSize","gatherPolicy","_config","transceivers","_sdpSessionId","generateSessionId","_sdpSessionVersion","_dtlsRole","_isClosed","onicecandidate","onaddstream","ontrack","onremovestream","onsignalingstatechange","oniceconnectionstatechange","onconnectionstatechange","onicegatheringstatechange","onnegotiationneeded","ondatachannel","_emitGatheringStateChange","getConfiguration","_createTransceiver","doNotAdd","hasBundleTransport","recvEncodingParameters","associatedRemoteMediaStreams","wantReceive","transports","_createIceAndDtlsTransports","_maybeFireNegotiationNeeded","clonedStream","clone","clonedTrack","_createIceGatherer","bufferedCandidateEvents","bufferCandidates","end","state","_gather","onlocalcandidate","evt","cand","component","ufrag","serializedCandidate","writeCandidate","getMediaSections","getDescription","complete","every","RTCIceTransport","onicestatechange","_updateIceConnectionState","_updateConnectionState","RTCDtlsTransport","ondtlsstatechange","onerror","_disposeIceAndDtlsTransports","_transceive","recv","params","encodings","rtcp","cname","compound","rtcpParameters","receive","sessionpart","parseRtpParameters","isIceLite","rejected","isRejected","remoteIceParameters","getIceParameters","remoteDtlsParameters","getDtlsParameters","role","start","_updateSignalingState","receiverList","iceOptions","lines","splitLines","getKind","getDirection","remoteMsid","parseMsid","getMid","generateIdentifier","parseRtpEncodingParameters","parseRtcpParameters","isComplete","cands","setTransport","setRemoteCandidates","getCapabilities","codec","isNewTrack","nativeTrack","hasRtx","sid","item","close","newState","states","closed","connected","disconnected","failed","new","connecting","numAudioTracks","numVideoTracks","writeSessionBoilerplate","remoteCodec","hdrExt","remoteExtensions","rHdrExt","getLocalCandidates","mediaSectionsInOffer","localTrack","reducedSize","candidateString","senderOrReceiver","promises","all","allStats","results","ortcObjects","ortcObjectName","nativeGetstats","nativeStats","mapStats","methods","random","blob","parts","part","substring","address","relatedAddress","relatedPort","tcpType","parseIceOptions","parseRtpMap","parsed","channels","writeRtpMap","parseExtmap","writeExtmap","headerExtension","preferredId","parseFmtp","kv","writeFmtp","param","parseRtcpFb","writeRtcpFb","parseSsrcMedia","sp","colon","attribute","parseSsrcGroup","semantics","ssrcs","parseFingerprint","algorithm","fingerprints","setupType","fp","iceParameters","password","mline","rtpmapline","fmtps","maxptime","extension","encodingParameters","hasRed","hasUlpfec","primarySsrc","secondarySsrc","flows","encParam","codecPayloadType","fec","mechanism","bandwidth","maxBitrate","remoteSsrc","rsize","mux","spec","planB","msidParts","sessId","sessVer","sessUser","sessionId","user","fmt","parseOLine","username","sessionVersion","netType","addressType","isValidSDP","OVERLAY_ID","OldModule","bundle","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","ws","onmessage","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","parcelRequire","generated","js","clear","hmrApply","v","hmrAcceptRun","reload","onclose","removeErrorOverlay","stack","overlay","createErrorOverlay","body","appendChild","getElementById","remove","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","k","dep","Array","isArray","Function","deps","cached","cache"],"mappings":"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","file":"adapter.231229a9.js","sourceRoot":"../www","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.adapter = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n\n'use strict';\n\nvar _adapter_factory = require('./adapter_factory.js');\n\nvar adapter = (0, _adapter_factory.adapterFactory)({ window: window });\nmodule.exports = adapter; // this is the difference from adapter_core.\n\n},{\"./adapter_factory.js\":2}],2:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.adapterFactory = adapterFactory;\n\nvar _utils = require('./utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nvar _chrome_shim = require('./chrome/chrome_shim');\n\nvar chromeShim = _interopRequireWildcard(_chrome_shim);\n\nvar _edge_shim = require('./edge/edge_shim');\n\nvar edgeShim = _interopRequireWildcard(_edge_shim);\n\nvar _firefox_shim = require('./firefox/firefox_shim');\n\nvar firefoxShim = _interopRequireWildcard(_firefox_shim);\n\nvar _safari_shim = require('./safari/safari_shim');\n\nvar safariShim = _interopRequireWildcard(_safari_shim);\n\nvar _common_shim = require('./common_shim');\n\nvar commonShim = _interopRequireWildcard(_common_shim);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n// Shimming starts here.\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\nfunction adapterFactory() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      window = _ref.window;\n\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n    shimChrome: true,\n    shimFirefox: true,\n    shimEdge: true,\n    shimSafari: true\n  };\n\n  // Utils.\n  var logging = utils.log;\n  var browserDetails = utils.detectBrowser(window);\n\n  var adapter = {\n    browserDetails: browserDetails,\n    commonShim: commonShim,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings\n  };\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection || !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n\n      chromeShim.shimGetUserMedia(window);\n      chromeShim.shimMediaStream(window);\n      chromeShim.shimPeerConnection(window);\n      chromeShim.shimOnTrack(window);\n      chromeShim.shimAddTrackRemoveTrack(window);\n      chromeShim.shimGetSendersWithDtmf(window);\n      chromeShim.shimGetStats(window);\n      chromeShim.shimSenderReceiverGetStats(window);\n      chromeShim.fixNegotiationNeeded(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimConnectionState(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      commonShim.removeAllowExtmapMixed(window);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection || !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n\n      firefoxShim.shimGetUserMedia(window);\n      firefoxShim.shimPeerConnection(window);\n      firefoxShim.shimOnTrack(window);\n      firefoxShim.shimRemoveStream(window);\n      firefoxShim.shimSenderGetStats(window);\n      firefoxShim.shimReceiverGetStats(window);\n      firefoxShim.shimRTCDataChannel(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimConnectionState(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      break;\n    case 'edge':\n      if (!edgeShim || !edgeShim.shimPeerConnection || !options.shimEdge) {\n        logging('MS edge shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming edge.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = edgeShim;\n\n      edgeShim.shimGetUserMedia(window);\n      edgeShim.shimGetDisplayMedia(window);\n      edgeShim.shimPeerConnection(window);\n      edgeShim.shimReplaceTrack(window);\n\n      // the edge shim implements the full RTCIceCandidate object.\n\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n\n      safariShim.shimRTCIceServerUrls(window);\n      safariShim.shimCreateOfferLegacy(window);\n      safariShim.shimCallbacksAPI(window);\n      safariShim.shimLocalStreamsAPI(window);\n      safariShim.shimRemoteStreamsAPI(window);\n      safariShim.shimTrackEventTransceiver(window);\n      safariShim.shimGetUserMedia(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      commonShim.removeAllowExtmapMixed(window);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n\n  return adapter;\n}\n\n// Browser shims.\n\n},{\"./chrome/chrome_shim\":3,\"./common_shim\":6,\"./edge/edge_shim\":7,\"./firefox/firefox_shim\":11,\"./safari/safari_shim\":14,\"./utils\":15}],3:[function(require,module,exports){\n\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _getusermedia = require('./getusermedia');\n\nObject.defineProperty(exports, 'shimGetUserMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getusermedia.shimGetUserMedia;\n  }\n});\n\nvar _getdisplaymedia = require('./getdisplaymedia');\n\nObject.defineProperty(exports, 'shimGetDisplayMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getdisplaymedia.shimGetDisplayMedia;\n  }\n});\nexports.shimMediaStream = shimMediaStream;\nexports.shimOnTrack = shimOnTrack;\nexports.shimGetSendersWithDtmf = shimGetSendersWithDtmf;\nexports.shimGetStats = shimGetStats;\nexports.shimSenderReceiverGetStats = shimSenderReceiverGetStats;\nexports.shimAddTrackRemoveTrackWithNative = shimAddTrackRemoveTrackWithNative;\nexports.shimAddTrackRemoveTrack = shimAddTrackRemoveTrack;\nexports.shimPeerConnection = shimPeerConnection;\nexports.fixNegotiationNeeded = fixNegotiationNeeded;\n\nvar _utils = require('../utils.js');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction shimMediaStream(window) {\n  window.MediaStream = window.MediaStream || window.webkitMediaStream;\n}\n\nfunction shimOnTrack(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && !('ontrack' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n      get: function get() {\n        return this._ontrack;\n      },\n      set: function set(f) {\n        if (this._ontrack) {\n          this.removeEventListener('track', this._ontrack);\n        }\n        this.addEventListener('track', this._ontrack = f);\n      },\n\n      enumerable: true,\n      configurable: true\n    });\n    var origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription = function () {\n      var _this = this;\n\n      if (!this._ontrackpoly) {\n        this._ontrackpoly = function (e) {\n          // onaddstream does not fire when a track is added to an existing\n          // stream. But stream.onaddtrack is implemented so we use that.\n          e.stream.addEventListener('addtrack', function (te) {\n            var receiver = void 0;\n            if (window.RTCPeerConnection.prototype.getReceivers) {\n              receiver = _this.getReceivers().find(function (r) {\n                return r.track && r.track.id === te.track.id;\n              });\n            } else {\n              receiver = { track: te.track };\n            }\n\n            var event = new Event('track');\n            event.track = te.track;\n            event.receiver = receiver;\n            event.transceiver = { receiver: receiver };\n            event.streams = [e.stream];\n            _this.dispatchEvent(event);\n          });\n          e.stream.getTracks().forEach(function (track) {\n            var receiver = void 0;\n            if (window.RTCPeerConnection.prototype.getReceivers) {\n              receiver = _this.getReceivers().find(function (r) {\n                return r.track && r.track.id === track.id;\n              });\n            } else {\n              receiver = { track: track };\n            }\n            var event = new Event('track');\n            event.track = track;\n            event.receiver = receiver;\n            event.transceiver = { receiver: receiver };\n            event.streams = [e.stream];\n            _this.dispatchEvent(event);\n          });\n        };\n        this.addEventListener('addstream', this._ontrackpoly);\n      }\n      return origSetRemoteDescription.apply(this, arguments);\n    };\n  } else {\n    // even if RTCRtpTransceiver is in window, it is only used and\n    // emitted in unified-plan. Unfortunately this means we need\n    // to unconditionally wrap the event.\n    utils.wrapPeerConnectionEvent(window, 'track', function (e) {\n      if (!e.transceiver) {\n        Object.defineProperty(e, 'transceiver', { value: { receiver: e.receiver } });\n      }\n      return e;\n    });\n  }\n}\n\nfunction shimGetSendersWithDtmf(window) {\n  // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && !('getSenders' in window.RTCPeerConnection.prototype) && 'createDTMFSender' in window.RTCPeerConnection.prototype) {\n    var shimSenderWithDtmf = function shimSenderWithDtmf(pc, track) {\n      return {\n        track: track,\n        get dtmf() {\n          if (this._dtmf === undefined) {\n            if (track.kind === 'audio') {\n              this._dtmf = pc.createDTMFSender(track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        },\n        _pc: pc\n      };\n    };\n\n    // augment addTrack when getSenders is not available.\n    if (!window.RTCPeerConnection.prototype.getSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function () {\n        this._senders = this._senders || [];\n        return this._senders.slice(); // return a copy of the internal state.\n      };\n      var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addTrack = function (track, stream) {\n        var sender = origAddTrack.apply(this, arguments);\n        if (!sender) {\n          sender = shimSenderWithDtmf(this, track);\n          this._senders.push(sender);\n        }\n        return sender;\n      };\n\n      var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n      window.RTCPeerConnection.prototype.removeTrack = function (sender) {\n        origRemoveTrack.apply(this, arguments);\n        var idx = this._senders.indexOf(sender);\n        if (idx !== -1) {\n          this._senders.splice(idx, 1);\n        }\n      };\n    }\n    var origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function (stream) {\n      var _this2 = this;\n\n      this._senders = this._senders || [];\n      origAddStream.apply(this, [stream]);\n      stream.getTracks().forEach(function (track) {\n        _this2._senders.push(shimSenderWithDtmf(_this2, track));\n      });\n    };\n\n    var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream = function (stream) {\n      var _this3 = this;\n\n      this._senders = this._senders || [];\n      origRemoveStream.apply(this, [stream]);\n\n      stream.getTracks().forEach(function (track) {\n        var sender = _this3._senders.find(function (s) {\n          return s.track === track;\n        });\n        if (sender) {\n          // remove sender\n          _this3._senders.splice(_this3._senders.indexOf(sender), 1);\n        }\n      });\n    };\n  } else if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && 'getSenders' in window.RTCPeerConnection.prototype && 'createDTMFSender' in window.RTCPeerConnection.prototype && window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\n    var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    window.RTCPeerConnection.prototype.getSenders = function () {\n      var _this4 = this;\n\n      var senders = origGetSenders.apply(this, []);\n      senders.forEach(function (sender) {\n        return sender._pc = _this4;\n      });\n      return senders;\n    };\n\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get: function get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = this._pc.createDTMFSender(this.track);\n          } else {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n}\n\nfunction shimGetStats(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  var origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function (selector, successCallback, errorCallback) {\n    var _this5 = this;\n\n    var args = arguments;\n\n    // If selector is a function then we are in the old style stats so just\n    // pass back the original getStats format to avoid breaking old users.\n    if (arguments.length > 0 && typeof selector === 'function') {\n      return origGetStats.apply(this, arguments);\n    }\n\n    // When spec-style getStats is supported, return those when called with\n    // either no arguments or the selector argument is null.\n    if (origGetStats.length === 0 && (arguments.length === 0 || typeof arguments[0] !== 'function')) {\n      return origGetStats.apply(this, []);\n    }\n\n    var fixChromeStats_ = function fixChromeStats_(response) {\n      var standardReport = {};\n      var reports = response.result();\n      reports.forEach(function (report) {\n        var standardStats = {\n          id: report.id,\n          timestamp: report.timestamp,\n          type: {\n            localcandidate: 'local-candidate',\n            remotecandidate: 'remote-candidate'\n          }[report.type] || report.type\n        };\n        report.names().forEach(function (name) {\n          standardStats[name] = report.stat(name);\n        });\n        standardReport[standardStats.id] = standardStats;\n      });\n\n      return standardReport;\n    };\n\n    // shim getStats with maplike support\n    var makeMapStats = function makeMapStats(stats) {\n      return new Map(Object.keys(stats).map(function (key) {\n        return [key, stats[key]];\n      }));\n    };\n\n    if (arguments.length >= 2) {\n      var successCallbackWrapper_ = function successCallbackWrapper_(response) {\n        args[1](makeMapStats(fixChromeStats_(response)));\n      };\n\n      return origGetStats.apply(this, [successCallbackWrapper_, arguments[0]]);\n    }\n\n    // promise-support\n    return new Promise(function (resolve, reject) {\n      origGetStats.apply(_this5, [function (response) {\n        resolve(makeMapStats(fixChromeStats_(response)));\n      }, reject]);\n    }).then(successCallback, errorCallback);\n  };\n}\n\nfunction shimSenderReceiverGetStats(window) {\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender && window.RTCRtpReceiver)) {\n    return;\n  }\n\n  // shim sender stats.\n  if (!('getStats' in window.RTCRtpSender.prototype)) {\n    var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function () {\n        var _this6 = this;\n\n        var senders = origGetSenders.apply(this, []);\n        senders.forEach(function (sender) {\n          return sender._pc = _this6;\n        });\n        return senders;\n      };\n    }\n\n    var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function () {\n        var sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function () {\n      var sender = this;\n      return this._pc.getStats().then(function (result) {\n        return (\n          /* Note: this will include stats of all senders that\n           *   send a track with the same id as sender.track as\n           *   it is not possible to identify the RTCRtpSender.\n           */\n          utils.filterStats(result, sender.track, true)\n        );\n      });\n    };\n  }\n\n  // shim receiver stats.\n  if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n    var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers = function () {\n        var _this7 = this;\n\n        var receivers = origGetReceivers.apply(this, []);\n        receivers.forEach(function (receiver) {\n          return receiver._pc = _this7;\n        });\n        return receivers;\n      };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', function (e) {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function () {\n      var receiver = this;\n      return this._pc.getStats().then(function (result) {\n        return utils.filterStats(result, receiver.track, false);\n      });\n    };\n  }\n\n  if (!('getStats' in window.RTCRtpSender.prototype && 'getStats' in window.RTCRtpReceiver.prototype)) {\n    return;\n  }\n\n  // shim RTCPeerConnection.getStats(track).\n  var origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function () {\n    if (arguments.length > 0 && arguments[0] instanceof window.MediaStreamTrack) {\n      var track = arguments[0];\n      var sender = void 0;\n      var receiver = void 0;\n      var err = void 0;\n      this.getSenders().forEach(function (s) {\n        if (s.track === track) {\n          if (sender) {\n            err = true;\n          } else {\n            sender = s;\n          }\n        }\n      });\n      this.getReceivers().forEach(function (r) {\n        if (r.track === track) {\n          if (receiver) {\n            err = true;\n          } else {\n            receiver = r;\n          }\n        }\n        return r.track === track;\n      });\n      if (err || sender && receiver) {\n        return Promise.reject(new DOMException('There are more than one sender or receiver for the track.', 'InvalidAccessError'));\n      } else if (sender) {\n        return sender.getStats();\n      } else if (receiver) {\n        return receiver.getStats();\n      }\n      return Promise.reject(new DOMException('There is no sender or receiver for the track.', 'InvalidAccessError'));\n    }\n    return origGetStats.apply(this, arguments);\n  };\n}\n\nfunction shimAddTrackRemoveTrackWithNative(window) {\n  // shim addTrack/removeTrack with native variants in order to make\n  // the interactions with legacy getLocalStreams behave as in other browsers.\n  // Keeps a mapping stream.id => [stream, rtpsenders...]\n  window.RTCPeerConnection.prototype.getLocalStreams = function () {\n    var _this8 = this;\n\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n    return Object.keys(this._shimmedLocalStreams).map(function (streamId) {\n      return _this8._shimmedLocalStreams[streamId][0];\n    });\n  };\n\n  var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  window.RTCPeerConnection.prototype.addTrack = function (track, stream) {\n    if (!stream) {\n      return origAddTrack.apply(this, arguments);\n    }\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n    var sender = origAddTrack.apply(this, arguments);\n    if (!this._shimmedLocalStreams[stream.id]) {\n      this._shimmedLocalStreams[stream.id] = [stream, sender];\n    } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n      this._shimmedLocalStreams[stream.id].push(sender);\n    }\n    return sender;\n  };\n\n  var origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function (stream) {\n    var _this9 = this;\n\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n    stream.getTracks().forEach(function (track) {\n      var alreadyExists = _this9.getSenders().find(function (s) {\n        return s.track === track;\n      });\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.', 'InvalidAccessError');\n      }\n    });\n    var existingSenders = this.getSenders();\n    origAddStream.apply(this, arguments);\n    var newSenders = this.getSenders().filter(function (newSender) {\n      return existingSenders.indexOf(newSender) === -1;\n    });\n    this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n  };\n\n  var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream = function (stream) {\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n    delete this._shimmedLocalStreams[stream.id];\n    return origRemoveStream.apply(this, arguments);\n  };\n\n  var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n  window.RTCPeerConnection.prototype.removeTrack = function (sender) {\n    var _this10 = this;\n\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n    if (sender) {\n      Object.keys(this._shimmedLocalStreams).forEach(function (streamId) {\n        var idx = _this10._shimmedLocalStreams[streamId].indexOf(sender);\n        if (idx !== -1) {\n          _this10._shimmedLocalStreams[streamId].splice(idx, 1);\n        }\n        if (_this10._shimmedLocalStreams[streamId].length === 1) {\n          delete _this10._shimmedLocalStreams[streamId];\n        }\n      });\n    }\n    return origRemoveTrack.apply(this, arguments);\n  };\n}\n\nfunction shimAddTrackRemoveTrack(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  var browserDetails = utils.detectBrowser(window);\n  // shim addTrack and removeTrack.\n  if (window.RTCPeerConnection.prototype.addTrack && browserDetails.version >= 65) {\n    return shimAddTrackRemoveTrackWithNative(window);\n  }\n\n  // also shim pc.getLocalStreams when addTrack is shimmed\n  // to return the original streams.\n  var origGetLocalStreams = window.RTCPeerConnection.prototype.getLocalStreams;\n  window.RTCPeerConnection.prototype.getLocalStreams = function () {\n    var _this11 = this;\n\n    var nativeStreams = origGetLocalStreams.apply(this);\n    this._reverseStreams = this._reverseStreams || {};\n    return nativeStreams.map(function (stream) {\n      return _this11._reverseStreams[stream.id];\n    });\n  };\n\n  var origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function (stream) {\n    var _this12 = this;\n\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n\n    stream.getTracks().forEach(function (track) {\n      var alreadyExists = _this12.getSenders().find(function (s) {\n        return s.track === track;\n      });\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.', 'InvalidAccessError');\n      }\n    });\n    // Add identity mapping for consistency with addTrack.\n    // Unless this is being used with a stream from addTrack.\n    if (!this._reverseStreams[stream.id]) {\n      var newStream = new window.MediaStream(stream.getTracks());\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      stream = newStream;\n    }\n    origAddStream.apply(this, [stream]);\n  };\n\n  var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream = function (stream) {\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n\n    origRemoveStream.apply(this, [this._streams[stream.id] || stream]);\n    delete this._reverseStreams[this._streams[stream.id] ? this._streams[stream.id].id : stream.id];\n    delete this._streams[stream.id];\n  };\n\n  window.RTCPeerConnection.prototype.addTrack = function (track, stream) {\n    var _this13 = this;\n\n    if (this.signalingState === 'closed') {\n      throw new DOMException('The RTCPeerConnection\\'s signalingState is \\'closed\\'.', 'InvalidStateError');\n    }\n    var streams = [].slice.call(arguments, 1);\n    if (streams.length !== 1 || !streams[0].getTracks().find(function (t) {\n      return t === track;\n    })) {\n      // this is not fully correct but all we can manage without\n      // [[associated MediaStreams]] internal slot.\n      throw new DOMException('The adapter.js addTrack polyfill only supports a single ' + ' stream which is associated with the specified track.', 'NotSupportedError');\n    }\n\n    var alreadyExists = this.getSenders().find(function (s) {\n      return s.track === track;\n    });\n    if (alreadyExists) {\n      throw new DOMException('Track already exists.', 'InvalidAccessError');\n    }\n\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n    var oldStream = this._streams[stream.id];\n    if (oldStream) {\n      // this is using odd Chrome behaviour, use with caution:\n      // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n      // Note: we rely on the high-level addTrack/dtmf shim to\n      // create the sender with a dtmf sender.\n      oldStream.addTrack(track);\n\n      // Trigger ONN async.\n      Promise.resolve().then(function () {\n        _this13.dispatchEvent(new Event('negotiationneeded'));\n      });\n    } else {\n      var newStream = new window.MediaStream([track]);\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      this.addStream(newStream);\n    }\n    return this.getSenders().find(function (s) {\n      return s.track === track;\n    });\n  };\n\n  // replace the internal stream id with the external one and\n  // vice versa.\n  function replaceInternalStreamId(pc, description) {\n    var sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(function (internalId) {\n      var externalStream = pc._reverseStreams[internalId];\n      var internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(internalStream.id, 'g'), externalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp: sdp\n    });\n  }\n  function replaceExternalStreamId(pc, description) {\n    var sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(function (internalId) {\n      var externalStream = pc._reverseStreams[internalId];\n      var internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(externalStream.id, 'g'), internalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp: sdp\n    });\n  }\n  ['createOffer', 'createAnswer'].forEach(function (method) {\n    var nativeMethod = window.RTCPeerConnection.prototype[method];\n    window.RTCPeerConnection.prototype[method] = function () {\n      var _this14 = this;\n\n      var args = arguments;\n      var isLegacyCall = arguments.length && typeof arguments[0] === 'function';\n      if (isLegacyCall) {\n        return nativeMethod.apply(this, [function (description) {\n          var desc = replaceInternalStreamId(_this14, description);\n          args[0].apply(null, [desc]);\n        }, function (err) {\n          if (args[1]) {\n            args[1].apply(null, err);\n          }\n        }, arguments[2]]);\n      }\n      return nativeMethod.apply(this, arguments).then(function (description) {\n        return replaceInternalStreamId(_this14, description);\n      });\n    };\n  });\n\n  var origSetLocalDescription = window.RTCPeerConnection.prototype.setLocalDescription;\n  window.RTCPeerConnection.prototype.setLocalDescription = function () {\n    if (!arguments.length || !arguments[0].type) {\n      return origSetLocalDescription.apply(this, arguments);\n    }\n    arguments[0] = replaceExternalStreamId(this, arguments[0]);\n    return origSetLocalDescription.apply(this, arguments);\n  };\n\n  // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n  var origLocalDescription = Object.getOwnPropertyDescriptor(window.RTCPeerConnection.prototype, 'localDescription');\n  Object.defineProperty(window.RTCPeerConnection.prototype, 'localDescription', {\n    get: function get() {\n      var description = origLocalDescription.get.apply(this);\n      if (description.type === '') {\n        return description;\n      }\n      return replaceInternalStreamId(this, description);\n    }\n  });\n\n  window.RTCPeerConnection.prototype.removeTrack = function (sender) {\n    var _this15 = this;\n\n    if (this.signalingState === 'closed') {\n      throw new DOMException('The RTCPeerConnection\\'s signalingState is \\'closed\\'.', 'InvalidStateError');\n    }\n    // We can not yet check for sender instanceof RTCRtpSender\n    // since we shim RTPSender. So we check if sender._pc is set.\n    if (!sender._pc) {\n      throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' + 'does not implement interface RTCRtpSender.', 'TypeError');\n    }\n    var isLocal = sender._pc === this;\n    if (!isLocal) {\n      throw new DOMException('Sender was not created by this connection.', 'InvalidAccessError');\n    }\n\n    // Search for the native stream the senders track belongs to.\n    this._streams = this._streams || {};\n    var stream = void 0;\n    Object.keys(this._streams).forEach(function (streamid) {\n      var hasTrack = _this15._streams[streamid].getTracks().find(function (track) {\n        return sender.track === track;\n      });\n      if (hasTrack) {\n        stream = _this15._streams[streamid];\n      }\n    });\n\n    if (stream) {\n      if (stream.getTracks().length === 1) {\n        // if this is the last track of the stream, remove the stream. This\n        // takes care of any shimmed _senders.\n        this.removeStream(this._reverseStreams[stream.id]);\n      } else {\n        // relying on the same odd chrome behaviour as above.\n        stream.removeTrack(sender.track);\n      }\n      this.dispatchEvent(new Event('negotiationneeded'));\n    }\n  };\n}\n\nfunction shimPeerConnection(window) {\n  if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.webkitRTCPeerConnection;\n  }\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n  ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'].forEach(function (method) {\n    var nativeMethod = window.RTCPeerConnection.prototype[method];\n    window.RTCPeerConnection.prototype[method] = function () {\n      arguments[0] = new (method === 'addIceCandidate' ? window.RTCIceCandidate : window.RTCSessionDescription)(arguments[0]);\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  // support for addIceCandidate(null or undefined)\n  var nativeAddIceCandidate = window.RTCPeerConnection.prototype.addIceCandidate;\n  window.RTCPeerConnection.prototype.addIceCandidate = function () {\n    if (!arguments[0]) {\n      if (arguments[1]) {\n        arguments[1].apply(null);\n      }\n      return Promise.resolve();\n    }\n    return nativeAddIceCandidate.apply(this, arguments);\n  };\n}\n\nfunction fixNegotiationNeeded(window) {\n  utils.wrapPeerConnectionEvent(window, 'negotiationneeded', function (e) {\n    var pc = e.target;\n    if (pc.signalingState !== 'stable') {\n      return;\n    }\n    return e;\n  });\n}\n\n},{\"../utils.js\":15,\"./getdisplaymedia\":4,\"./getusermedia\":5}],4:[function(require,module,exports){\n/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = shimGetDisplayMedia;\nfunction shimGetDisplayMedia(window, getSourceId) {\n  if (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!window.navigator.mediaDevices) {\n    return;\n  }\n  // getSourceId is a function that returns a promise resolving with\n  // the sourceId of the screen/window/tab to be shared.\n  if (typeof getSourceId !== 'function') {\n    console.error('shimGetDisplayMedia: getSourceId argument is not ' + 'a function');\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia = function (constraints) {\n    return getSourceId(constraints).then(function (sourceId) {\n      var widthSpecified = constraints.video && constraints.video.width;\n      var heightSpecified = constraints.video && constraints.video.height;\n      var frameRateSpecified = constraints.video && constraints.video.frameRate;\n      constraints.video = {\n        mandatory: {\n          chromeMediaSource: 'desktop',\n          chromeMediaSourceId: sourceId,\n          maxFrameRate: frameRateSpecified || 3\n        }\n      };\n      if (widthSpecified) {\n        constraints.video.mandatory.maxWidth = widthSpecified;\n      }\n      if (heightSpecified) {\n        constraints.video.mandatory.maxHeight = heightSpecified;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    });\n  };\n}\n\n},{}],5:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.shimGetUserMedia = shimGetUserMedia;\n\nvar _utils = require('../utils.js');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nvar logging = utils.log;\n\nfunction shimGetUserMedia(window) {\n  var navigator = window && window.navigator;\n\n  if (!navigator.mediaDevices) {\n    return;\n  }\n\n  var browserDetails = utils.detectBrowser(window);\n\n  var constraintsToChrome_ = function constraintsToChrome_(c) {\n    if ((typeof c === 'undefined' ? 'undefined' : _typeof(c)) !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    var cc = {};\n    Object.keys(c).forEach(function (key) {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      var r = _typeof(c[key]) === 'object' ? c[key] : { ideal: c[key] };\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      var oldname_ = function oldname_(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return name === 'deviceId' ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        var oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(function (mix) {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  var shimConstraints_ = function shimConstraints_(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && _typeof(constraints.audio) === 'object') {\n      var remap = function remap(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && _typeof(constraints.video) === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      var face = constraints.video.facingMode;\n      face = face && ((typeof face === 'undefined' ? 'undefined' : _typeof(face)) === 'object' ? face : { ideal: face });\n      var getSupportedFacingModeLies = browserDetails.version < 66;\n\n      if (face && (face.exact === 'user' || face.exact === 'environment' || face.ideal === 'user' || face.ideal === 'environment') && !(navigator.mediaDevices.getSupportedConstraints && navigator.mediaDevices.getSupportedConstraints().facingMode && !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        var matches = void 0;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices().then(function (devices) {\n            devices = devices.filter(function (d) {\n              return d.kind === 'videoinput';\n            });\n            var dev = devices.find(function (d) {\n              return matches.some(function (match) {\n                return d.label.toLowerCase().includes(match);\n              });\n            });\n            if (!dev && devices.length && matches.includes('back')) {\n              dev = devices[devices.length - 1]; // more likely the back cam\n            }\n            if (dev) {\n              constraints.video.deviceId = face.exact ? { exact: dev.deviceId } : { ideal: dev.deviceId };\n            }\n            constraints.video = constraintsToChrome_(constraints.video);\n            logging('chrome: ' + JSON.stringify(constraints));\n            return func(constraints);\n          });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  var shimError_ = function shimError_(e) {\n    if (browserDetails.version >= 64) {\n      return e;\n    }\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        PermissionDismissedError: 'NotAllowedError',\n        InvalidStateError: 'NotAllowedError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n        MediaDeviceKillSwitchOn: 'NotAllowedError',\n        TabCaptureError: 'AbortError',\n        ScreenCaptureError: 'AbortError',\n        DeviceCaptureError: 'AbortError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint || e.constraintName,\n      toString: function toString() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  var getUserMedia_ = function getUserMedia_(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, function (c) {\n      navigator.webkitGetUserMedia(c, onSuccess, function (e) {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n  navigator.getUserMedia = getUserMedia_.bind(navigator);\n\n  // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n  // function which returns a Promise, it does not accept spec-style\n  // constraints.\n  if (navigator.mediaDevices.getUserMedia) {\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function (cs) {\n      return shimConstraints_(cs, function (c) {\n        return origGetUserMedia(c).then(function (stream) {\n          if (c.audio && !stream.getAudioTracks().length || c.video && !stream.getVideoTracks().length) {\n            stream.getTracks().forEach(function (track) {\n              track.stop();\n            });\n            throw new DOMException('', 'NotFoundError');\n          }\n          return stream;\n        }, function (e) {\n          return Promise.reject(shimError_(e));\n        });\n      });\n    };\n  }\n}\n\n},{\"../utils.js\":15}],6:[function(require,module,exports){\n/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.shimRTCIceCandidate = shimRTCIceCandidate;\nexports.shimMaxMessageSize = shimMaxMessageSize;\nexports.shimSendThrowTypeError = shimSendThrowTypeError;\nexports.shimConnectionState = shimConnectionState;\nexports.removeAllowExtmapMixed = removeAllowExtmapMixed;\n\nvar _sdp = require('sdp');\n\nvar _sdp2 = _interopRequireDefault(_sdp);\n\nvar _utils = require('./utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction shimRTCIceCandidate(window) {\n  // foundation is arbitrarily chosen as an indicator for full support for\n  // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n  if (!window.RTCIceCandidate || window.RTCIceCandidate && 'foundation' in window.RTCIceCandidate.prototype) {\n    return;\n  }\n\n  var NativeRTCIceCandidate = window.RTCIceCandidate;\n  window.RTCIceCandidate = function (args) {\n    // Remove the a= which shouldn't be part of the candidate string.\n    if ((typeof args === 'undefined' ? 'undefined' : _typeof(args)) === 'object' && args.candidate && args.candidate.indexOf('a=') === 0) {\n      args = JSON.parse(JSON.stringify(args));\n      args.candidate = args.candidate.substr(2);\n    }\n\n    if (args.candidate && args.candidate.length) {\n      // Augment the native candidate with the parsed fields.\n      var nativeCandidate = new NativeRTCIceCandidate(args);\n      var parsedCandidate = _sdp2.default.parseCandidate(args.candidate);\n      var augmentedCandidate = Object.assign(nativeCandidate, parsedCandidate);\n\n      // Add a serializer that does not serialize the extra attributes.\n      augmentedCandidate.toJSON = function () {\n        return {\n          candidate: augmentedCandidate.candidate,\n          sdpMid: augmentedCandidate.sdpMid,\n          sdpMLineIndex: augmentedCandidate.sdpMLineIndex,\n          usernameFragment: augmentedCandidate.usernameFragment\n        };\n      };\n      return augmentedCandidate;\n    }\n    return new NativeRTCIceCandidate(args);\n  };\n  window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', function (e) {\n    if (e.candidate) {\n      Object.defineProperty(e, 'candidate', {\n        value: new window.RTCIceCandidate(e.candidate),\n        writable: 'false'\n      });\n    }\n    return e;\n  });\n}\n\nfunction shimMaxMessageSize(window) {\n  if (window.RTCSctpTransport || !window.RTCPeerConnection) {\n    return;\n  }\n  var browserDetails = utils.detectBrowser(window);\n\n  if (!('sctp' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n      get: function get() {\n        return typeof this._sctp === 'undefined' ? null : this._sctp;\n      }\n    });\n  }\n\n  var sctpInDescription = function sctpInDescription(description) {\n    if (!description || !description.sdp) {\n      return false;\n    }\n    var sections = _sdp2.default.splitSections(description.sdp);\n    sections.shift();\n    return sections.some(function (mediaSection) {\n      var mLine = _sdp2.default.parseMLine(mediaSection);\n      return mLine && mLine.kind === 'application' && mLine.protocol.indexOf('SCTP') !== -1;\n    });\n  };\n\n  var getRemoteFirefoxVersion = function getRemoteFirefoxVersion(description) {\n    // TODO: Is there a better solution for detecting Firefox?\n    var match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n    if (match === null || match.length < 2) {\n      return -1;\n    }\n    var version = parseInt(match[1], 10);\n    // Test for NaN (yes, this is ugly)\n    return version !== version ? -1 : version;\n  };\n\n  var getCanSendMaxMessageSize = function getCanSendMaxMessageSize(remoteIsFirefox) {\n    // Every implementation we know can send at least 64 KiB.\n    // Note: Although Chrome is technically able to send up to 256 KiB, the\n    //       data does not reach the other peer reliably.\n    //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n    var canSendMaxMessageSize = 65536;\n    if (browserDetails.browser === 'firefox') {\n      if (browserDetails.version < 57) {\n        if (remoteIsFirefox === -1) {\n          // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n          // fragmentation.\n          canSendMaxMessageSize = 16384;\n        } else {\n          // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n          // messages. Thus, supporting ~2 GiB when sending.\n          canSendMaxMessageSize = 2147483637;\n        }\n      } else if (browserDetails.version < 60) {\n        // Currently, all FF >= 57 will reset the remote maximum message size\n        // to the default value when a data channel is created at a later\n        // stage. :(\n        // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n        canSendMaxMessageSize = browserDetails.version === 57 ? 65535 : 65536;\n      } else {\n        // FF >= 60 supports sending ~2 GiB\n        canSendMaxMessageSize = 2147483637;\n      }\n    }\n    return canSendMaxMessageSize;\n  };\n\n  var getMaxMessageSize = function getMaxMessageSize(description, remoteIsFirefox) {\n    // Note: 65536 bytes is the default value from the SDP spec. Also,\n    //       every implementation we know supports receiving 65536 bytes.\n    var maxMessageSize = 65536;\n\n    // FF 57 has a slightly incorrect default remote max message size, so\n    // we need to adjust it here to avoid a failure when sending.\n    // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n    if (browserDetails.browser === 'firefox' && browserDetails.version === 57) {\n      maxMessageSize = 65535;\n    }\n\n    var match = _sdp2.default.matchPrefix(description.sdp, 'a=max-message-size:');\n    if (match.length > 0) {\n      maxMessageSize = parseInt(match[0].substr(19), 10);\n    } else if (browserDetails.browser === 'firefox' && remoteIsFirefox !== -1) {\n      // If the maximum message size is not present in the remote SDP and\n      // both local and remote are Firefox, the remote peer can receive\n      // ~2 GiB.\n      maxMessageSize = 2147483637;\n    }\n    return maxMessageSize;\n  };\n\n  var origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription = function () {\n    this._sctp = null;\n\n    if (sctpInDescription(arguments[0])) {\n      // Check if the remote is FF.\n      var isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n      // Get the maximum message size the local peer is capable of sending\n      var canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n      // Get the maximum message size of the remote peer.\n      var remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n      // Determine final maximum message size\n      var maxMessageSize = void 0;\n      if (canSendMMS === 0 && remoteMMS === 0) {\n        maxMessageSize = Number.POSITIVE_INFINITY;\n      } else if (canSendMMS === 0 || remoteMMS === 0) {\n        maxMessageSize = Math.max(canSendMMS, remoteMMS);\n      } else {\n        maxMessageSize = Math.min(canSendMMS, remoteMMS);\n      }\n\n      // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n      // attribute.\n      var sctp = {};\n      Object.defineProperty(sctp, 'maxMessageSize', {\n        get: function get() {\n          return maxMessageSize;\n        }\n      });\n      this._sctp = sctp;\n    }\n\n    return origSetRemoteDescription.apply(this, arguments);\n  };\n}\n\nfunction shimSendThrowTypeError(window) {\n  if (!(window.RTCPeerConnection && 'createDataChannel' in window.RTCPeerConnection.prototype)) {\n    return;\n  }\n\n  // Note: Although Firefox >= 57 has a native implementation, the maximum\n  //       message size can be reset for all data channels at a later stage.\n  //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n  function wrapDcSend(dc, pc) {\n    var origDataChannelSend = dc.send;\n    dc.send = function () {\n      var data = arguments[0];\n      var length = data.length || data.size || data.byteLength;\n      if (dc.readyState === 'open' && pc.sctp && length > pc.sctp.maxMessageSize) {\n        throw new TypeError('Message too large (can send a maximum of ' + pc.sctp.maxMessageSize + ' bytes)');\n      }\n      return origDataChannelSend.apply(dc, arguments);\n    };\n  }\n  var origCreateDataChannel = window.RTCPeerConnection.prototype.createDataChannel;\n  window.RTCPeerConnection.prototype.createDataChannel = function () {\n    var dataChannel = origCreateDataChannel.apply(this, arguments);\n    wrapDcSend(dataChannel, this);\n    return dataChannel;\n  };\n  utils.wrapPeerConnectionEvent(window, 'datachannel', function (e) {\n    wrapDcSend(e.channel, e.target);\n    return e;\n  });\n}\n\n/* shims RTCConnectionState by pretending it is the same as iceConnectionState.\n * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\n * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\n * since DTLS failures would be hidden. See\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\n * for the Firefox tracking bug.\n */\nfunction shimConnectionState(window) {\n  if (!window.RTCPeerConnection || 'connectionState' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  var proto = window.RTCPeerConnection.prototype;\n  Object.defineProperty(proto, 'connectionState', {\n    get: function get() {\n      return {\n        completed: 'connected',\n        checking: 'connecting'\n      }[this.iceConnectionState] || this.iceConnectionState;\n    },\n\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(proto, 'onconnectionstatechange', {\n    get: function get() {\n      return this._onconnectionstatechange || null;\n    },\n    set: function set(cb) {\n      if (this._onconnectionstatechange) {\n        this.removeEventListener('connectionstatechange', this._onconnectionstatechange);\n        delete this._onconnectionstatechange;\n      }\n      if (cb) {\n        this.addEventListener('connectionstatechange', this._onconnectionstatechange = cb);\n      }\n    },\n\n    enumerable: true,\n    configurable: true\n  });\n\n  ['setLocalDescription', 'setRemoteDescription'].forEach(function (method) {\n    var origMethod = proto[method];\n    proto[method] = function () {\n      if (!this._connectionstatechangepoly) {\n        this._connectionstatechangepoly = function (e) {\n          var pc = e.target;\n          if (pc._lastConnectionState !== pc.connectionState) {\n            pc._lastConnectionState = pc.connectionState;\n            var newEvent = new Event('connectionstatechange', e);\n            pc.dispatchEvent(newEvent);\n          }\n          return e;\n        };\n        this.addEventListener('iceconnectionstatechange', this._connectionstatechangepoly);\n      }\n      return origMethod.apply(this, arguments);\n    };\n  });\n}\n\nfunction removeAllowExtmapMixed(window) {\n  /* remove a=extmap-allow-mixed for Chrome < M71 */\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  var browserDetails = utils.detectBrowser(window);\n  if (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\n    return;\n  }\n  var nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription = function (desc) {\n    if (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\n      desc.sdp = desc.sdp.split('\\n').filter(function (line) {\n        return line.trim() !== 'a=extmap-allow-mixed';\n      }).join('\\n');\n    }\n    return nativeSRD.apply(this, arguments);\n  };\n}\n\n},{\"./utils\":15,\"sdp\":17}],7:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\n\nvar _getusermedia = require('./getusermedia');\n\nObject.defineProperty(exports, 'shimGetUserMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getusermedia.shimGetUserMedia;\n  }\n});\n\nvar _getdisplaymedia = require('./getdisplaymedia');\n\nObject.defineProperty(exports, 'shimGetDisplayMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getdisplaymedia.shimGetDisplayMedia;\n  }\n});\nexports.shimPeerConnection = shimPeerConnection;\nexports.shimReplaceTrack = shimReplaceTrack;\n\nvar _utils = require('../utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nvar _filtericeservers = require('./filtericeservers');\n\nvar _rtcpeerconnectionShim = require('rtcpeerconnection-shim');\n\nvar _rtcpeerconnectionShim2 = _interopRequireDefault(_rtcpeerconnectionShim);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction shimPeerConnection(window) {\n  var browserDetails = utils.detectBrowser(window);\n\n  if (window.RTCIceGatherer) {\n    if (!window.RTCIceCandidate) {\n      window.RTCIceCandidate = function (args) {\n        return args;\n      };\n    }\n    if (!window.RTCSessionDescription) {\n      window.RTCSessionDescription = function (args) {\n        return args;\n      };\n    }\n    // this adds an additional event listener to MediaStrackTrack that signals\n    // when a tracks enabled property was changed. Workaround for a bug in\n    // addStream, see below. No longer required in 15025+\n    if (browserDetails.version < 15025) {\n      var origMSTEnabled = Object.getOwnPropertyDescriptor(window.MediaStreamTrack.prototype, 'enabled');\n      Object.defineProperty(window.MediaStreamTrack.prototype, 'enabled', {\n        set: function set(value) {\n          origMSTEnabled.set.call(this, value);\n          var ev = new Event('enabled');\n          ev.enabled = value;\n          this.dispatchEvent(ev);\n        }\n      });\n    }\n  }\n\n  // ORTC defines the DTMF sender a bit different.\n  // https://github.com/w3c/ortc/issues/714\n  if (window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get: function get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = new window.RTCDtmfSender(this);\n          } else if (this.track.kind === 'video') {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n  // Edge currently only implements the RTCDtmfSender, not the\n  // RTCDTMFSender alias. See http://draft.ortc.org/#rtcdtmfsender2*\n  if (window.RTCDtmfSender && !window.RTCDTMFSender) {\n    window.RTCDTMFSender = window.RTCDtmfSender;\n  }\n\n  var RTCPeerConnectionShim = (0, _rtcpeerconnectionShim2.default)(window, browserDetails.version);\n  window.RTCPeerConnection = function (config) {\n    if (config && config.iceServers) {\n      config.iceServers = (0, _filtericeservers.filterIceServers)(config.iceServers, browserDetails.version);\n      utils.log('ICE servers after filtering:', config.iceServers);\n    }\n    return new RTCPeerConnectionShim(config);\n  };\n  window.RTCPeerConnection.prototype = RTCPeerConnectionShim.prototype;\n}\n\nfunction shimReplaceTrack(window) {\n  // ORTC has replaceTrack -- https://github.com/w3c/ortc/issues/614\n  if (window.RTCRtpSender && !('replaceTrack' in window.RTCRtpSender.prototype)) {\n    window.RTCRtpSender.prototype.replaceTrack = window.RTCRtpSender.prototype.setTrack;\n  }\n}\n\n},{\"../utils\":15,\"./filtericeservers\":8,\"./getdisplaymedia\":9,\"./getusermedia\":10,\"rtcpeerconnection-shim\":16}],8:[function(require,module,exports){\n/*\n *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.filterIceServers = filterIceServers;\n\nvar _utils = require('../utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nfunction filterIceServers(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function (server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function (url) {\n        // filter STUN unconditionally.\n        if (url.indexOf('stun:') === 0) {\n          return false;\n        }\n\n        var validTurn = url.startsWith('turn') && !url.startsWith('turn:[') && url.includes('transport=udp');\n        if (validTurn && !hasTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return validTurn && !hasTurn;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n\n},{\"../utils\":15}],9:[function(require,module,exports){\n/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = shimGetDisplayMedia;\nfunction shimGetDisplayMedia(window) {\n  if (!('getDisplayMedia' in window.navigator)) {\n    return;\n  }\n  if (!window.navigator.mediaDevices) {\n    return;\n  }\n  if (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia = window.navigator.getDisplayMedia.bind(window.navigator);\n}\n\n},{}],10:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetUserMedia = shimGetUserMedia;\nfunction shimGetUserMedia(window) {\n  var navigator = window && window.navigator;\n\n  var shimError_ = function shimError_(e) {\n    return {\n      name: { PermissionDeniedError: 'NotAllowedError' }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint,\n      toString: function toString() {\n        return this.name;\n      }\n    };\n  };\n\n  // getUserMedia error shim.\n  var origGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\n  navigator.mediaDevices.getUserMedia = function (c) {\n    return origGetUserMedia(c).catch(function (e) {\n      return Promise.reject(shimError_(e));\n    });\n  };\n}\n\n},{}],11:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _getusermedia = require('./getusermedia');\n\nObject.defineProperty(exports, 'shimGetUserMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getusermedia.shimGetUserMedia;\n  }\n});\n\nvar _getdisplaymedia = require('./getdisplaymedia');\n\nObject.defineProperty(exports, 'shimGetDisplayMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getdisplaymedia.shimGetDisplayMedia;\n  }\n});\nexports.shimOnTrack = shimOnTrack;\nexports.shimPeerConnection = shimPeerConnection;\nexports.shimSenderGetStats = shimSenderGetStats;\nexports.shimReceiverGetStats = shimReceiverGetStats;\nexports.shimRemoveStream = shimRemoveStream;\nexports.shimRTCDataChannel = shimRTCDataChannel;\n\nvar _utils = require('../utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction shimOnTrack(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCTrackEvent && 'receiver' in window.RTCTrackEvent.prototype && !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get: function get() {\n        return { receiver: this.receiver };\n      }\n    });\n  }\n}\n\nfunction shimPeerConnection(window) {\n  var browserDetails = utils.detectBrowser(window);\n\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n    return; // probably media.peerconnection.enabled=false in about:config\n  }\n  if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.mozRTCPeerConnection;\n  }\n\n  // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n  ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'].forEach(function (method) {\n    var nativeMethod = window.RTCPeerConnection.prototype[method];\n    window.RTCPeerConnection.prototype[method] = function () {\n      arguments[0] = new (method === 'addIceCandidate' ? window.RTCIceCandidate : window.RTCSessionDescription)(arguments[0]);\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  // support for addIceCandidate(null or undefined)\n  var nativeAddIceCandidate = window.RTCPeerConnection.prototype.addIceCandidate;\n  window.RTCPeerConnection.prototype.addIceCandidate = function () {\n    if (!arguments[0]) {\n      if (arguments[1]) {\n        arguments[1].apply(null);\n      }\n      return Promise.resolve();\n    }\n    return nativeAddIceCandidate.apply(this, arguments);\n  };\n\n  var modernStatsTypes = {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  };\n\n  var nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function (selector, onSucc, onErr) {\n    return nativeGetStats.apply(this, [selector || null]).then(function (stats) {\n      if (browserDetails.version < 53 && !onSucc) {\n        // Shim only promise getStats with spec-hyphens in type names\n        // Leave callback version alone; misc old uses of forEach before Map\n        try {\n          stats.forEach(function (stat) {\n            stat.type = modernStatsTypes[stat.type] || stat.type;\n          });\n        } catch (e) {\n          if (e.name !== 'TypeError') {\n            throw e;\n          }\n          // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n          stats.forEach(function (stat, i) {\n            stats.set(i, Object.assign({}, stat, {\n              type: modernStatsTypes[stat.type] || stat.type\n            }));\n          });\n        }\n      }\n      return stats;\n    }).then(onSucc, onErr);\n  };\n}\n\nfunction shimSenderGetStats(window) {\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n    return;\n  }\n  var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n  if (origGetSenders) {\n    window.RTCPeerConnection.prototype.getSenders = function () {\n      var _this = this;\n\n      var senders = origGetSenders.apply(this, []);\n      senders.forEach(function (sender) {\n        return sender._pc = _this;\n      });\n      return senders;\n    };\n  }\n\n  var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  if (origAddTrack) {\n    window.RTCPeerConnection.prototype.addTrack = function () {\n      var sender = origAddTrack.apply(this, arguments);\n      sender._pc = this;\n      return sender;\n    };\n  }\n  window.RTCRtpSender.prototype.getStats = function () {\n    return this.track ? this._pc.getStats(this.track) : Promise.resolve(new Map());\n  };\n}\n\nfunction shimReceiverGetStats(window) {\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n    return;\n  }\n  var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n  if (origGetReceivers) {\n    window.RTCPeerConnection.prototype.getReceivers = function () {\n      var _this2 = this;\n\n      var receivers = origGetReceivers.apply(this, []);\n      receivers.forEach(function (receiver) {\n        return receiver._pc = _this2;\n      });\n      return receivers;\n    };\n  }\n  utils.wrapPeerConnectionEvent(window, 'track', function (e) {\n    e.receiver._pc = e.srcElement;\n    return e;\n  });\n  window.RTCRtpReceiver.prototype.getStats = function () {\n    return this._pc.getStats(this.track);\n  };\n}\n\nfunction shimRemoveStream(window) {\n  if (!window.RTCPeerConnection || 'removeStream' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.removeStream = function (stream) {\n    var _this3 = this;\n\n    utils.deprecated('removeStream', 'removeTrack');\n    this.getSenders().forEach(function (sender) {\n      if (sender.track && stream.getTracks().includes(sender.track)) {\n        _this3.removeTrack(sender);\n      }\n    });\n  };\n}\n\nfunction shimRTCDataChannel(window) {\n  // rename DataChannel to RTCDataChannel (native fix in FF60):\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n  if (window.DataChannel && !window.RTCDataChannel) {\n    window.RTCDataChannel = window.DataChannel;\n  }\n}\n\n},{\"../utils\":15,\"./getdisplaymedia\":12,\"./getusermedia\":13}],12:[function(require,module,exports){\n/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = shimGetDisplayMedia;\nfunction shimGetDisplayMedia(window, preferredMediaSource) {\n  if (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!window.navigator.mediaDevices) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia = function (constraints) {\n    if (!(constraints && constraints.video)) {\n      var err = new DOMException('getDisplayMedia without video ' + 'constraints is undefined');\n      err.name = 'NotFoundError';\n      // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n      err.code = 8;\n      return Promise.reject(err);\n    }\n    if (constraints.video === true) {\n      constraints.video = { mediaSource: preferredMediaSource };\n    } else {\n      constraints.video.mediaSource = preferredMediaSource;\n    }\n    return window.navigator.mediaDevices.getUserMedia(constraints);\n  };\n}\n\n},{}],13:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.shimGetUserMedia = shimGetUserMedia;\n\nvar _utils = require('../utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction shimGetUserMedia(window) {\n  var browserDetails = utils.detectBrowser(window);\n  var navigator = window && window.navigator;\n  var MediaStreamTrack = window && window.MediaStreamTrack;\n\n  navigator.getUserMedia = function (constraints, onSuccess, onError) {\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia', 'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n\n  if (!(browserDetails.version > 55 && 'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    var remap = function remap(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n\n    var nativeGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function (c) {\n      if ((typeof c === 'undefined' ? 'undefined' : _typeof(c)) === 'object' && _typeof(c.audio) === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      var nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function () {\n        var obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      var nativeApplyConstraints = MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function (c) {\n        if (this.kind === 'audio' && (typeof c === 'undefined' ? 'undefined' : _typeof(c)) === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n}\n\n},{\"../utils\":15}],14:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.shimLocalStreamsAPI = shimLocalStreamsAPI;\nexports.shimRemoteStreamsAPI = shimRemoteStreamsAPI;\nexports.shimCallbacksAPI = shimCallbacksAPI;\nexports.shimGetUserMedia = shimGetUserMedia;\nexports.shimConstraints = shimConstraints;\nexports.shimRTCIceServerUrls = shimRTCIceServerUrls;\nexports.shimTrackEventTransceiver = shimTrackEventTransceiver;\nexports.shimCreateOfferLegacy = shimCreateOfferLegacy;\n\nvar _utils = require('../utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction shimLocalStreamsAPI(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getLocalStreams = function () {\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      return this._localStreams;\n    };\n  }\n  if (!('addStream' in window.RTCPeerConnection.prototype)) {\n    var _addTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addStream = function (stream) {\n      var _this = this;\n\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      if (!this._localStreams.includes(stream)) {\n        this._localStreams.push(stream);\n      }\n      stream.getTracks().forEach(function (track) {\n        return _addTrack.call(_this, track, stream);\n      });\n    };\n\n    window.RTCPeerConnection.prototype.addTrack = function (track, stream) {\n      if (stream) {\n        if (!this._localStreams) {\n          this._localStreams = [stream];\n        } else if (!this._localStreams.includes(stream)) {\n          this._localStreams.push(stream);\n        }\n      }\n      return _addTrack.call(this, track, stream);\n    };\n  }\n  if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.removeStream = function (stream) {\n      var _this2 = this;\n\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      var index = this._localStreams.indexOf(stream);\n      if (index === -1) {\n        return;\n      }\n      this._localStreams.splice(index, 1);\n      var tracks = stream.getTracks();\n      this.getSenders().forEach(function (sender) {\n        if (tracks.includes(sender.track)) {\n          _this2.removeTrack(sender);\n        }\n      });\n    };\n  }\n}\n\nfunction shimRemoteStreamsAPI(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getRemoteStreams = function () {\n      return this._remoteStreams ? this._remoteStreams : [];\n    };\n  }\n  if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n      get: function get() {\n        return this._onaddstream;\n      },\n      set: function set(f) {\n        var _this3 = this;\n\n        if (this._onaddstream) {\n          this.removeEventListener('addstream', this._onaddstream);\n          this.removeEventListener('track', this._onaddstreampoly);\n        }\n        this.addEventListener('addstream', this._onaddstream = f);\n        this.addEventListener('track', this._onaddstreampoly = function (e) {\n          e.streams.forEach(function (stream) {\n            if (!_this3._remoteStreams) {\n              _this3._remoteStreams = [];\n            }\n            if (_this3._remoteStreams.includes(stream)) {\n              return;\n            }\n            _this3._remoteStreams.push(stream);\n            var event = new Event('addstream');\n            event.stream = stream;\n            _this3.dispatchEvent(event);\n          });\n        });\n      }\n    });\n    var origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription = function () {\n      var pc = this;\n      if (!this._onaddstreampoly) {\n        this.addEventListener('track', this._onaddstreampoly = function (e) {\n          e.streams.forEach(function (stream) {\n            if (!pc._remoteStreams) {\n              pc._remoteStreams = [];\n            }\n            if (pc._remoteStreams.indexOf(stream) >= 0) {\n              return;\n            }\n            pc._remoteStreams.push(stream);\n            var event = new Event('addstream');\n            event.stream = stream;\n            pc.dispatchEvent(event);\n          });\n        });\n      }\n      return origSetRemoteDescription.apply(pc, arguments);\n    };\n  }\n}\n\nfunction shimCallbacksAPI(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  var prototype = window.RTCPeerConnection.prototype;\n  var createOffer = prototype.createOffer;\n  var createAnswer = prototype.createAnswer;\n  var setLocalDescription = prototype.setLocalDescription;\n  var setRemoteDescription = prototype.setRemoteDescription;\n  var addIceCandidate = prototype.addIceCandidate;\n\n  prototype.createOffer = function (successCallback, failureCallback) {\n    var options = arguments.length >= 2 ? arguments[2] : arguments[0];\n    var promise = createOffer.apply(this, [options]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n\n  prototype.createAnswer = function (successCallback, failureCallback) {\n    var options = arguments.length >= 2 ? arguments[2] : arguments[0];\n    var promise = createAnswer.apply(this, [options]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n\n  var withCallback = function withCallback(description, successCallback, failureCallback) {\n    var promise = setLocalDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setLocalDescription = withCallback;\n\n  withCallback = function withCallback(description, successCallback, failureCallback) {\n    var promise = setRemoteDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setRemoteDescription = withCallback;\n\n  withCallback = function withCallback(candidate, successCallback, failureCallback) {\n    var promise = addIceCandidate.apply(this, [candidate]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.addIceCandidate = withCallback;\n}\n\nfunction shimGetUserMedia(window) {\n  var navigator = window && window.navigator;\n\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    // shim not needed in Safari 12.1\n    var mediaDevices = navigator.mediaDevices;\n    var _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\n    navigator.mediaDevices.getUserMedia = function (constraints) {\n      return _getUserMedia(shimConstraints(constraints));\n    };\n  }\n\n  if (!navigator.getUserMedia && navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    navigator.getUserMedia = function (constraints, cb, errcb) {\n      navigator.mediaDevices.getUserMedia(constraints).then(cb, errcb);\n    }.bind(navigator);\n  }\n}\n\nfunction shimConstraints(constraints) {\n  if (constraints && constraints.video !== undefined) {\n    return Object.assign({}, constraints, { video: utils.compactObject(constraints.video) });\n  }\n\n  return constraints;\n}\n\nfunction shimRTCIceServerUrls(window) {\n  // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n  var OrigPeerConnection = window.RTCPeerConnection;\n  window.RTCPeerConnection = function (pcConfig, pcConstraints) {\n    if (pcConfig && pcConfig.iceServers) {\n      var newIceServers = [];\n      for (var i = 0; i < pcConfig.iceServers.length; i++) {\n        var server = pcConfig.iceServers[i];\n        if (!server.hasOwnProperty('urls') && server.hasOwnProperty('url')) {\n          utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n          server = JSON.parse(JSON.stringify(server));\n          server.urls = server.url;\n          delete server.url;\n          newIceServers.push(server);\n        } else {\n          newIceServers.push(pcConfig.iceServers[i]);\n        }\n      }\n      pcConfig.iceServers = newIceServers;\n    }\n    return new OrigPeerConnection(pcConfig, pcConstraints);\n  };\n  window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n  // wrap static methods. Currently just generateCertificate.\n  if ('generateCertificate' in window.RTCPeerConnection) {\n    Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n      get: function get() {\n        return OrigPeerConnection.generateCertificate;\n      }\n    });\n  }\n}\n\nfunction shimTrackEventTransceiver(window) {\n  // Add event.transceiver member over deprecated event.receiver\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && 'receiver' in window.RTCTrackEvent.prototype &&\n  // can't check 'transceiver' in window.RTCTrackEvent.prototype, as it is\n  // defined for some reason even when window.RTCTransceiver is not.\n  !window.RTCTransceiver) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get: function get() {\n        return { receiver: this.receiver };\n      }\n    });\n  }\n}\n\nfunction shimCreateOfferLegacy(window) {\n  var origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function (offerOptions) {\n    if (offerOptions) {\n      if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n        // support bit values\n        offerOptions.offerToReceiveAudio = !!offerOptions.offerToReceiveAudio;\n      }\n      var audioTransceiver = this.getTransceivers().find(function (transceiver) {\n        return transceiver.sender.track && transceiver.sender.track.kind === 'audio';\n      });\n      if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n        if (audioTransceiver.direction === 'sendrecv') {\n          if (audioTransceiver.setDirection) {\n            audioTransceiver.setDirection('sendonly');\n          } else {\n            audioTransceiver.direction = 'sendonly';\n          }\n        } else if (audioTransceiver.direction === 'recvonly') {\n          if (audioTransceiver.setDirection) {\n            audioTransceiver.setDirection('inactive');\n          } else {\n            audioTransceiver.direction = 'inactive';\n          }\n        }\n      } else if (offerOptions.offerToReceiveAudio === true && !audioTransceiver) {\n        this.addTransceiver('audio');\n      }\n\n      if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n        // support bit values\n        offerOptions.offerToReceiveVideo = !!offerOptions.offerToReceiveVideo;\n      }\n      var videoTransceiver = this.getTransceivers().find(function (transceiver) {\n        return transceiver.sender.track && transceiver.sender.track.kind === 'video';\n      });\n      if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n        if (videoTransceiver.direction === 'sendrecv') {\n          if (videoTransceiver.setDirection) {\n            videoTransceiver.setDirection('sendonly');\n          } else {\n            videoTransceiver.direction = 'sendonly';\n          }\n        } else if (videoTransceiver.direction === 'recvonly') {\n          if (videoTransceiver.setDirection) {\n            videoTransceiver.setDirection('inactive');\n          } else {\n            videoTransceiver.direction = 'inactive';\n          }\n        }\n      } else if (offerOptions.offerToReceiveVideo === true && !videoTransceiver) {\n        this.addTransceiver('video');\n      }\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\n\n},{\"../utils\":15}],15:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.extractVersion = extractVersion;\nexports.wrapPeerConnectionEvent = wrapPeerConnectionEvent;\nexports.disableLog = disableLog;\nexports.disableWarnings = disableWarnings;\nexports.log = log;\nexports.deprecated = deprecated;\nexports.detectBrowser = detectBrowser;\nexports.compactObject = compactObject;\nexports.walkStats = walkStats;\nexports.filterStats = filterStats;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar logDisabled_ = true;\nvar deprecationWarnings_ = true;\n\n/**\n * Extract browser version out of the provided user agent string.\n *\n * @param {!string} uastring userAgent string.\n * @param {!string} expr Regular expression used as match criteria.\n * @param {!number} pos position in the version string to be returned.\n * @return {!number} browser version.\n */\nfunction extractVersion(uastring, expr, pos) {\n  var match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n}\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object (or false to prevent\n// the event).\nfunction wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  var proto = window.RTCPeerConnection.prototype;\n  var nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function (nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    var wrappedCallback = function wrappedCallback(e) {\n      var modifiedEvent = wrapper(e);\n      if (modifiedEvent) {\n        cb(modifiedEvent);\n      }\n    };\n    this._eventMap = this._eventMap || {};\n    this._eventMap[cb] = wrappedCallback;\n    return nativeAddEventListener.apply(this, [nativeEventName, wrappedCallback]);\n  };\n\n  var nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function (nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap || !this._eventMap[cb]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    var unwrappedCb = this._eventMap[cb];\n    delete this._eventMap[cb];\n    return nativeRemoveEventListener.apply(this, [nativeEventName, unwrappedCb]);\n  };\n\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get: function get() {\n      return this['_on' + eventNameToWrap];\n    },\n    set: function set(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap, this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap, this['_on' + eventNameToWrap] = cb);\n      }\n    },\n\n    enumerable: true,\n    configurable: true\n  });\n}\n\nfunction disableLog(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + (typeof bool === 'undefined' ? 'undefined' : _typeof(bool)) + '. Please use a boolean.');\n  }\n  logDisabled_ = bool;\n  return bool ? 'adapter.js logging disabled' : 'adapter.js logging enabled';\n}\n\n/**\n * Disable or enable deprecation warnings\n * @param {!boolean} bool set to true to disable warnings.\n */\nfunction disableWarnings(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + (typeof bool === 'undefined' ? 'undefined' : _typeof(bool)) + '. Please use a boolean.');\n  }\n  deprecationWarnings_ = !bool;\n  return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n}\n\nfunction log() {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object') {\n    if (logDisabled_) {\n      return;\n    }\n    if (typeof console !== 'undefined' && typeof console.log === 'function') {\n      console.log.apply(console, arguments);\n    }\n  }\n}\n\n/**\n * Shows a deprecation warning suggesting the modern and spec-compatible API.\n */\nfunction deprecated(oldMethod, newMethod) {\n  if (!deprecationWarnings_) {\n    return;\n  }\n  console.warn(oldMethod + ' is deprecated, please use ' + newMethod + ' instead.');\n}\n\n/**\n * Browser detector.\n *\n * @return {object} result containing browser and version\n *     properties.\n */\nfunction detectBrowser(window) {\n  var navigator = window.navigator;\n\n  // Returned result object.\n\n  var result = { browser: null, version: null };\n\n  // Fail early if it's not a browser\n  if (typeof window === 'undefined' || !window.navigator) {\n    result.browser = 'Not a browser.';\n    return result;\n  }\n\n  if (navigator.mozGetUserMedia) {\n    // Firefox.\n    result.browser = 'firefox';\n    result.version = extractVersion(navigator.userAgent, /Firefox\\/(\\d+)\\./, 1);\n  } else if (navigator.webkitGetUserMedia) {\n    // Chrome, Chromium, Webview, Opera.\n    // Version matches Chrome/WebRTC version.\n    result.browser = 'chrome';\n    result.version = extractVersion(navigator.userAgent, /Chrom(e|ium)\\/(\\d+)\\./, 2);\n  } else if (navigator.mediaDevices && navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) {\n    // Edge.\n    result.browser = 'edge';\n    result.version = extractVersion(navigator.userAgent, /Edge\\/(\\d+).(\\d+)$/, 2);\n  } else if (window.RTCPeerConnection && navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) {\n    // Safari.\n    result.browser = 'safari';\n    result.version = extractVersion(navigator.userAgent, /AppleWebKit\\/(\\d+)\\./, 1);\n  } else {\n    // Default fallthrough: not supported.\n    result.browser = 'Not a supported browser.';\n    return result;\n  }\n\n  return result;\n}\n\n/**\n * Remove all empty objects and undefined values\n * from a nested object -- an enhanced and vanilla version\n * of Lodash's `compact`.\n */\nfunction compactObject(data) {\n  if ((typeof data === 'undefined' ? 'undefined' : _typeof(data)) !== 'object') {\n    return data;\n  }\n\n  return Object.keys(data).reduce(function (accumulator, key) {\n    var isObject = _typeof(data[key]) === 'object';\n    var value = isObject ? compactObject(data[key]) : data[key];\n    var isEmptyObject = isObject && !Object.keys(value).length;\n    if (value === undefined || isEmptyObject) {\n      return accumulator;\n    }\n\n    return Object.assign(accumulator, _defineProperty({}, key, value));\n  }, {});\n}\n\n/* iterates the stats graph recursively. */\nfunction walkStats(stats, base, resultSet) {\n  if (!base || resultSet.has(base.id)) {\n    return;\n  }\n  resultSet.set(base.id, base);\n  Object.keys(base).forEach(function (name) {\n    if (name.endsWith('Id')) {\n      walkStats(stats, stats.get(base[name]), resultSet);\n    } else if (name.endsWith('Ids')) {\n      base[name].forEach(function (id) {\n        walkStats(stats, stats.get(id), resultSet);\n      });\n    }\n  });\n}\n\n/* filter getStats for a sender/receiver track. */\nfunction filterStats(result, track, outbound) {\n  var streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n  var filteredResult = new Map();\n  if (track === null) {\n    return filteredResult;\n  }\n  var trackStats = [];\n  result.forEach(function (value) {\n    if (value.type === 'track' && value.trackIdentifier === track.id) {\n      trackStats.push(value);\n    }\n  });\n  trackStats.forEach(function (trackStat) {\n    result.forEach(function (stats) {\n      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n        walkStats(result, stats, filteredResult);\n      }\n    });\n  });\n  return filteredResult;\n}\n\n},{}],16:[function(require,module,exports){\n/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar SDPUtils = require('sdp');\n\nfunction fixStatsType(stat) {\n  return {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  }[stat.type] || stat.type;\n}\n\nfunction writeMediaSection(transceiver, caps, type, stream, dtlsRole) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : dtlsRole || 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    var trackId = transceiver.rtpSender._initialTrackId ||\n        transceiver.rtpSender.track.id;\n    transceiver.rtpSender._initialTrackId = trackId;\n    // spec.\n    var msid = 'msid:' + (stream ? stream.id : '-') + ' ' +\n        trackId + '\\r\\n';\n    sdp += 'a=' + msid;\n    // for Chrome. Legacy should no longer be required.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n\n    // RTX\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n}\n\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nfunction filterIceServers(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function(server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        console.warn('RTCIceServer.url is deprecated! Use urls instead.');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function(url) {\n        var validTurn = url.indexOf('turn:') === 0 &&\n            url.indexOf('transport=udp') !== -1 &&\n            url.indexOf('turn:[') === -1 &&\n            !hasTurn;\n\n        if (validTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return url.indexOf('stun:') === 0 && edgeVersion >= 14393 &&\n            url.indexOf('?transport=udp') === -1;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n\n// Determines the intersection of local and remote capabilities.\nfunction getCommonCapabilities(localCapabilities, remoteCapabilities) {\n  var commonCapabilities = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: []\n  };\n\n  var findCodecByPayloadType = function(pt, codecs) {\n    pt = parseInt(pt, 10);\n    for (var i = 0; i < codecs.length; i++) {\n      if (codecs[i].payloadType === pt ||\n          codecs[i].preferredPayloadType === pt) {\n        return codecs[i];\n      }\n    }\n  };\n\n  var rtxCapabilityMatches = function(lRtx, rRtx, lCodecs, rCodecs) {\n    var lCodec = findCodecByPayloadType(lRtx.parameters.apt, lCodecs);\n    var rCodec = findCodecByPayloadType(rRtx.parameters.apt, rCodecs);\n    return lCodec && rCodec &&\n        lCodec.name.toLowerCase() === rCodec.name.toLowerCase();\n  };\n\n  localCapabilities.codecs.forEach(function(lCodec) {\n    for (var i = 0; i < remoteCapabilities.codecs.length; i++) {\n      var rCodec = remoteCapabilities.codecs[i];\n      if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&\n          lCodec.clockRate === rCodec.clockRate) {\n        if (lCodec.name.toLowerCase() === 'rtx' &&\n            lCodec.parameters && rCodec.parameters.apt) {\n          // for RTX we need to find the local rtx that has a apt\n          // which points to the same local codec as the remote one.\n          if (!rtxCapabilityMatches(lCodec, rCodec,\n              localCapabilities.codecs, remoteCapabilities.codecs)) {\n            continue;\n          }\n        }\n        rCodec = JSON.parse(JSON.stringify(rCodec)); // deepcopy\n        // number of channels is the highest common number of channels\n        rCodec.numChannels = Math.min(lCodec.numChannels,\n            rCodec.numChannels);\n        // push rCodec so we reply with offerer payload type\n        commonCapabilities.codecs.push(rCodec);\n\n        // determine common feedback mechanisms\n        rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {\n          for (var j = 0; j < lCodec.rtcpFeedback.length; j++) {\n            if (lCodec.rtcpFeedback[j].type === fb.type &&\n                lCodec.rtcpFeedback[j].parameter === fb.parameter) {\n              return true;\n            }\n          }\n          return false;\n        });\n        // FIXME: also need to determine .parameters\n        //  see https://github.com/openpeer/ortc/issues/569\n        break;\n      }\n    }\n  });\n\n  localCapabilities.headerExtensions.forEach(function(lHeaderExtension) {\n    for (var i = 0; i < remoteCapabilities.headerExtensions.length;\n         i++) {\n      var rHeaderExtension = remoteCapabilities.headerExtensions[i];\n      if (lHeaderExtension.uri === rHeaderExtension.uri) {\n        commonCapabilities.headerExtensions.push(rHeaderExtension);\n        break;\n      }\n    }\n  });\n\n  // FIXME: fecMechanisms\n  return commonCapabilities;\n}\n\n// is action=setLocalDescription with type allowed in signalingState\nfunction isActionAllowedInSignalingState(action, type, signalingState) {\n  return {\n    offer: {\n      setLocalDescription: ['stable', 'have-local-offer'],\n      setRemoteDescription: ['stable', 'have-remote-offer']\n    },\n    answer: {\n      setLocalDescription: ['have-remote-offer', 'have-local-pranswer'],\n      setRemoteDescription: ['have-local-offer', 'have-remote-pranswer']\n    }\n  }[type][action].indexOf(signalingState) !== -1;\n}\n\nfunction maybeAddCandidate(iceTransport, candidate) {\n  // Edge's internal representation adds some fields therefore\n  // not all fieldѕ are taken into account.\n  var alreadyAdded = iceTransport.getRemoteCandidates()\n      .find(function(remoteCandidate) {\n        return candidate.foundation === remoteCandidate.foundation &&\n            candidate.ip === remoteCandidate.ip &&\n            candidate.port === remoteCandidate.port &&\n            candidate.priority === remoteCandidate.priority &&\n            candidate.protocol === remoteCandidate.protocol &&\n            candidate.type === remoteCandidate.type;\n      });\n  if (!alreadyAdded) {\n    iceTransport.addRemoteCandidate(candidate);\n  }\n  return !alreadyAdded;\n}\n\n\nfunction makeError(name, description) {\n  var e = new Error(description);\n  e.name = name;\n  // legacy error codes from https://heycam.github.io/webidl/#idl-DOMException-error-names\n  e.code = {\n    NotSupportedError: 9,\n    InvalidStateError: 11,\n    InvalidAccessError: 15,\n    TypeError: undefined,\n    OperationError: undefined\n  }[name];\n  return e;\n}\n\nmodule.exports = function(window, edgeVersion) {\n  // https://w3c.github.io/mediacapture-main/#mediastream\n  // Helper function to add the track to the stream and\n  // dispatch the event ourselves.\n  function addTrackToStreamAndFireEvent(track, stream) {\n    stream.addTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('addtrack',\n        {track: track}));\n  }\n\n  function removeTrackFromStreamAndFireEvent(track, stream) {\n    stream.removeTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('removetrack',\n        {track: track}));\n  }\n\n  function fireAddTrack(pc, track, receiver, streams) {\n    var trackEvent = new Event('track');\n    trackEvent.track = track;\n    trackEvent.receiver = receiver;\n    trackEvent.transceiver = {receiver: receiver};\n    trackEvent.streams = streams;\n    window.setTimeout(function() {\n      pc._dispatchEvent('track', trackEvent);\n    });\n  }\n\n  var RTCPeerConnection = function(config) {\n    var pc = this;\n\n    var _eventTarget = document.createDocumentFragment();\n    ['addEventListener', 'removeEventListener', 'dispatchEvent']\n        .forEach(function(method) {\n          pc[method] = _eventTarget[method].bind(_eventTarget);\n        });\n\n    this.canTrickleIceCandidates = null;\n\n    this.needNegotiation = false;\n\n    this.localStreams = [];\n    this.remoteStreams = [];\n\n    this._localDescription = null;\n    this._remoteDescription = null;\n\n    this.signalingState = 'stable';\n    this.iceConnectionState = 'new';\n    this.connectionState = 'new';\n    this.iceGatheringState = 'new';\n\n    config = JSON.parse(JSON.stringify(config || {}));\n\n    this.usingBundle = config.bundlePolicy === 'max-bundle';\n    if (config.rtcpMuxPolicy === 'negotiate') {\n      throw(makeError('NotSupportedError',\n          'rtcpMuxPolicy \\'negotiate\\' is not supported'));\n    } else if (!config.rtcpMuxPolicy) {\n      config.rtcpMuxPolicy = 'require';\n    }\n\n    switch (config.iceTransportPolicy) {\n      case 'all':\n      case 'relay':\n        break;\n      default:\n        config.iceTransportPolicy = 'all';\n        break;\n    }\n\n    switch (config.bundlePolicy) {\n      case 'balanced':\n      case 'max-compat':\n      case 'max-bundle':\n        break;\n      default:\n        config.bundlePolicy = 'balanced';\n        break;\n    }\n\n    config.iceServers = filterIceServers(config.iceServers || [], edgeVersion);\n\n    this._iceGatherers = [];\n    if (config.iceCandidatePoolSize) {\n      for (var i = config.iceCandidatePoolSize; i > 0; i--) {\n        this._iceGatherers.push(new window.RTCIceGatherer({\n          iceServers: config.iceServers,\n          gatherPolicy: config.iceTransportPolicy\n        }));\n      }\n    } else {\n      config.iceCandidatePoolSize = 0;\n    }\n\n    this._config = config;\n\n    // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...\n    // everything that is needed to describe a SDP m-line.\n    this.transceivers = [];\n\n    this._sdpSessionId = SDPUtils.generateSessionId();\n    this._sdpSessionVersion = 0;\n\n    this._dtlsRole = undefined; // role for a=setup to use in answers.\n\n    this._isClosed = false;\n  };\n\n  Object.defineProperty(RTCPeerConnection.prototype, 'localDescription', {\n    configurable: true,\n    get: function() {\n      return this._localDescription;\n    }\n  });\n  Object.defineProperty(RTCPeerConnection.prototype, 'remoteDescription', {\n    configurable: true,\n    get: function() {\n      return this._remoteDescription;\n    }\n  });\n\n  // set up event handlers on prototype\n  RTCPeerConnection.prototype.onicecandidate = null;\n  RTCPeerConnection.prototype.onaddstream = null;\n  RTCPeerConnection.prototype.ontrack = null;\n  RTCPeerConnection.prototype.onremovestream = null;\n  RTCPeerConnection.prototype.onsignalingstatechange = null;\n  RTCPeerConnection.prototype.oniceconnectionstatechange = null;\n  RTCPeerConnection.prototype.onconnectionstatechange = null;\n  RTCPeerConnection.prototype.onicegatheringstatechange = null;\n  RTCPeerConnection.prototype.onnegotiationneeded = null;\n  RTCPeerConnection.prototype.ondatachannel = null;\n\n  RTCPeerConnection.prototype._dispatchEvent = function(name, event) {\n    if (this._isClosed) {\n      return;\n    }\n    this.dispatchEvent(event);\n    if (typeof this['on' + name] === 'function') {\n      this['on' + name](event);\n    }\n  };\n\n  RTCPeerConnection.prototype._emitGatheringStateChange = function() {\n    var event = new Event('icegatheringstatechange');\n    this._dispatchEvent('icegatheringstatechange', event);\n  };\n\n  RTCPeerConnection.prototype.getConfiguration = function() {\n    return this._config;\n  };\n\n  RTCPeerConnection.prototype.getLocalStreams = function() {\n    return this.localStreams;\n  };\n\n  RTCPeerConnection.prototype.getRemoteStreams = function() {\n    return this.remoteStreams;\n  };\n\n  // internal helper to create a transceiver object.\n  // (which is not yet the same as the WebRTC 1.0 transceiver)\n  RTCPeerConnection.prototype._createTransceiver = function(kind, doNotAdd) {\n    var hasBundleTransport = this.transceivers.length > 0;\n    var transceiver = {\n      track: null,\n      iceGatherer: null,\n      iceTransport: null,\n      dtlsTransport: null,\n      localCapabilities: null,\n      remoteCapabilities: null,\n      rtpSender: null,\n      rtpReceiver: null,\n      kind: kind,\n      mid: null,\n      sendEncodingParameters: null,\n      recvEncodingParameters: null,\n      stream: null,\n      associatedRemoteMediaStreams: [],\n      wantReceive: true\n    };\n    if (this.usingBundle && hasBundleTransport) {\n      transceiver.iceTransport = this.transceivers[0].iceTransport;\n      transceiver.dtlsTransport = this.transceivers[0].dtlsTransport;\n    } else {\n      var transports = this._createIceAndDtlsTransports();\n      transceiver.iceTransport = transports.iceTransport;\n      transceiver.dtlsTransport = transports.dtlsTransport;\n    }\n    if (!doNotAdd) {\n      this.transceivers.push(transceiver);\n    }\n    return transceiver;\n  };\n\n  RTCPeerConnection.prototype.addTrack = function(track, stream) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call addTrack on a closed peerconnection.');\n    }\n\n    var alreadyExists = this.transceivers.find(function(s) {\n      return s.track === track;\n    });\n\n    if (alreadyExists) {\n      throw makeError('InvalidAccessError', 'Track already exists.');\n    }\n\n    var transceiver;\n    for (var i = 0; i < this.transceivers.length; i++) {\n      if (!this.transceivers[i].track &&\n          this.transceivers[i].kind === track.kind) {\n        transceiver = this.transceivers[i];\n      }\n    }\n    if (!transceiver) {\n      transceiver = this._createTransceiver(track.kind);\n    }\n\n    this._maybeFireNegotiationNeeded();\n\n    if (this.localStreams.indexOf(stream) === -1) {\n      this.localStreams.push(stream);\n    }\n\n    transceiver.track = track;\n    transceiver.stream = stream;\n    transceiver.rtpSender = new window.RTCRtpSender(track,\n        transceiver.dtlsTransport);\n    return transceiver.rtpSender;\n  };\n\n  RTCPeerConnection.prototype.addStream = function(stream) {\n    var pc = this;\n    if (edgeVersion >= 15025) {\n      stream.getTracks().forEach(function(track) {\n        pc.addTrack(track, stream);\n      });\n    } else {\n      // Clone is necessary for local demos mostly, attaching directly\n      // to two different senders does not work (build 10547).\n      // Fixed in 15025 (or earlier)\n      var clonedStream = stream.clone();\n      stream.getTracks().forEach(function(track, idx) {\n        var clonedTrack = clonedStream.getTracks()[idx];\n        track.addEventListener('enabled', function(event) {\n          clonedTrack.enabled = event.enabled;\n        });\n      });\n      clonedStream.getTracks().forEach(function(track) {\n        pc.addTrack(track, clonedStream);\n      });\n    }\n  };\n\n  RTCPeerConnection.prototype.removeTrack = function(sender) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call removeTrack on a closed peerconnection.');\n    }\n\n    if (!(sender instanceof window.RTCRtpSender)) {\n      throw new TypeError('Argument 1 of RTCPeerConnection.removeTrack ' +\n          'does not implement interface RTCRtpSender.');\n    }\n\n    var transceiver = this.transceivers.find(function(t) {\n      return t.rtpSender === sender;\n    });\n\n    if (!transceiver) {\n      throw makeError('InvalidAccessError',\n          'Sender was not created by this connection.');\n    }\n    var stream = transceiver.stream;\n\n    transceiver.rtpSender.stop();\n    transceiver.rtpSender = null;\n    transceiver.track = null;\n    transceiver.stream = null;\n\n    // remove the stream from the set of local streams\n    var localStreams = this.transceivers.map(function(t) {\n      return t.stream;\n    });\n    if (localStreams.indexOf(stream) === -1 &&\n        this.localStreams.indexOf(stream) > -1) {\n      this.localStreams.splice(this.localStreams.indexOf(stream), 1);\n    }\n\n    this._maybeFireNegotiationNeeded();\n  };\n\n  RTCPeerConnection.prototype.removeStream = function(stream) {\n    var pc = this;\n    stream.getTracks().forEach(function(track) {\n      var sender = pc.getSenders().find(function(s) {\n        return s.track === track;\n      });\n      if (sender) {\n        pc.removeTrack(sender);\n      }\n    });\n  };\n\n  RTCPeerConnection.prototype.getSenders = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpSender;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpSender;\n    });\n  };\n\n  RTCPeerConnection.prototype.getReceivers = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpReceiver;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpReceiver;\n    });\n  };\n\n\n  RTCPeerConnection.prototype._createIceGatherer = function(sdpMLineIndex,\n      usingBundle) {\n    var pc = this;\n    if (usingBundle && sdpMLineIndex > 0) {\n      return this.transceivers[0].iceGatherer;\n    } else if (this._iceGatherers.length) {\n      return this._iceGatherers.shift();\n    }\n    var iceGatherer = new window.RTCIceGatherer({\n      iceServers: this._config.iceServers,\n      gatherPolicy: this._config.iceTransportPolicy\n    });\n    Object.defineProperty(iceGatherer, 'state',\n        {value: 'new', writable: true}\n    );\n\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = [];\n    this.transceivers[sdpMLineIndex].bufferCandidates = function(event) {\n      var end = !event.candidate || Object.keys(event.candidate).length === 0;\n      // polyfill since RTCIceGatherer.state is not implemented in\n      // Edge 10547 yet.\n      iceGatherer.state = end ? 'completed' : 'gathering';\n      if (pc.transceivers[sdpMLineIndex].bufferedCandidateEvents !== null) {\n        pc.transceivers[sdpMLineIndex].bufferedCandidateEvents.push(event);\n      }\n    };\n    iceGatherer.addEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    return iceGatherer;\n  };\n\n  // start gathering from an RTCIceGatherer.\n  RTCPeerConnection.prototype._gather = function(mid, sdpMLineIndex) {\n    var pc = this;\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer.onlocalcandidate) {\n      return;\n    }\n    var bufferedCandidateEvents =\n      this.transceivers[sdpMLineIndex].bufferedCandidateEvents;\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = null;\n    iceGatherer.removeEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    iceGatherer.onlocalcandidate = function(evt) {\n      if (pc.usingBundle && sdpMLineIndex > 0) {\n        // if we know that we use bundle we can drop candidates with\n        // ѕdpMLineIndex > 0. If we don't do this then our state gets\n        // confused since we dispose the extra ice gatherer.\n        return;\n      }\n      var event = new Event('icecandidate');\n      event.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};\n\n      var cand = evt.candidate;\n      // Edge emits an empty object for RTCIceCandidateComplete‥\n      var end = !cand || Object.keys(cand).length === 0;\n      if (end) {\n        // polyfill since RTCIceGatherer.state is not implemented in\n        // Edge 10547 yet.\n        if (iceGatherer.state === 'new' || iceGatherer.state === 'gathering') {\n          iceGatherer.state = 'completed';\n        }\n      } else {\n        if (iceGatherer.state === 'new') {\n          iceGatherer.state = 'gathering';\n        }\n        // RTCIceCandidate doesn't have a component, needs to be added\n        cand.component = 1;\n        // also the usernameFragment. TODO: update SDP to take both variants.\n        cand.ufrag = iceGatherer.getLocalParameters().usernameFragment;\n\n        var serializedCandidate = SDPUtils.writeCandidate(cand);\n        event.candidate = Object.assign(event.candidate,\n            SDPUtils.parseCandidate(serializedCandidate));\n\n        event.candidate.candidate = serializedCandidate;\n        event.candidate.toJSON = function() {\n          return {\n            candidate: event.candidate.candidate,\n            sdpMid: event.candidate.sdpMid,\n            sdpMLineIndex: event.candidate.sdpMLineIndex,\n            usernameFragment: event.candidate.usernameFragment\n          };\n        };\n      }\n\n      // update local description.\n      var sections = SDPUtils.getMediaSections(pc._localDescription.sdp);\n      if (!end) {\n        sections[event.candidate.sdpMLineIndex] +=\n            'a=' + event.candidate.candidate + '\\r\\n';\n      } else {\n        sections[event.candidate.sdpMLineIndex] +=\n            'a=end-of-candidates\\r\\n';\n      }\n      pc._localDescription.sdp =\n          SDPUtils.getDescription(pc._localDescription.sdp) +\n          sections.join('');\n      var complete = pc.transceivers.every(function(transceiver) {\n        return transceiver.iceGatherer &&\n            transceiver.iceGatherer.state === 'completed';\n      });\n\n      if (pc.iceGatheringState !== 'gathering') {\n        pc.iceGatheringState = 'gathering';\n        pc._emitGatheringStateChange();\n      }\n\n      // Emit candidate. Also emit null candidate when all gatherers are\n      // complete.\n      if (!end) {\n        pc._dispatchEvent('icecandidate', event);\n      }\n      if (complete) {\n        pc._dispatchEvent('icecandidate', new Event('icecandidate'));\n        pc.iceGatheringState = 'complete';\n        pc._emitGatheringStateChange();\n      }\n    };\n\n    // emit already gathered candidates.\n    window.setTimeout(function() {\n      bufferedCandidateEvents.forEach(function(e) {\n        iceGatherer.onlocalcandidate(e);\n      });\n    }, 0);\n  };\n\n  // Create ICE transport and DTLS transport.\n  RTCPeerConnection.prototype._createIceAndDtlsTransports = function() {\n    var pc = this;\n    var iceTransport = new window.RTCIceTransport(null);\n    iceTransport.onicestatechange = function() {\n      pc._updateIceConnectionState();\n      pc._updateConnectionState();\n    };\n\n    var dtlsTransport = new window.RTCDtlsTransport(iceTransport);\n    dtlsTransport.ondtlsstatechange = function() {\n      pc._updateConnectionState();\n    };\n    dtlsTransport.onerror = function() {\n      // onerror does not set state to failed by itself.\n      Object.defineProperty(dtlsTransport, 'state',\n          {value: 'failed', writable: true});\n      pc._updateConnectionState();\n    };\n\n    return {\n      iceTransport: iceTransport,\n      dtlsTransport: dtlsTransport\n    };\n  };\n\n  // Destroy ICE gatherer, ICE transport and DTLS transport.\n  // Without triggering the callbacks.\n  RTCPeerConnection.prototype._disposeIceAndDtlsTransports = function(\n      sdpMLineIndex) {\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer) {\n      delete iceGatherer.onlocalcandidate;\n      delete this.transceivers[sdpMLineIndex].iceGatherer;\n    }\n    var iceTransport = this.transceivers[sdpMLineIndex].iceTransport;\n    if (iceTransport) {\n      delete iceTransport.onicestatechange;\n      delete this.transceivers[sdpMLineIndex].iceTransport;\n    }\n    var dtlsTransport = this.transceivers[sdpMLineIndex].dtlsTransport;\n    if (dtlsTransport) {\n      delete dtlsTransport.ondtlsstatechange;\n      delete dtlsTransport.onerror;\n      delete this.transceivers[sdpMLineIndex].dtlsTransport;\n    }\n  };\n\n  // Start the RTP Sender and Receiver for a transceiver.\n  RTCPeerConnection.prototype._transceive = function(transceiver,\n      send, recv) {\n    var params = getCommonCapabilities(transceiver.localCapabilities,\n        transceiver.remoteCapabilities);\n    if (send && transceiver.rtpSender) {\n      params.encodings = transceiver.sendEncodingParameters;\n      params.rtcp = {\n        cname: SDPUtils.localCName,\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.recvEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpSender.send(params);\n    }\n    if (recv && transceiver.rtpReceiver && params.codecs.length > 0) {\n      // remove RTX field in Edge 14942\n      if (transceiver.kind === 'video'\n          && transceiver.recvEncodingParameters\n          && edgeVersion < 15019) {\n        transceiver.recvEncodingParameters.forEach(function(p) {\n          delete p.rtx;\n        });\n      }\n      if (transceiver.recvEncodingParameters.length) {\n        params.encodings = transceiver.recvEncodingParameters;\n      } else {\n        params.encodings = [{}];\n      }\n      params.rtcp = {\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.rtcpParameters.cname) {\n        params.rtcp.cname = transceiver.rtcpParameters.cname;\n      }\n      if (transceiver.sendEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpReceiver.receive(params);\n    }\n  };\n\n  RTCPeerConnection.prototype.setLocalDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setLocalDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set local ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var sections;\n    var sessionpart;\n    if (description.type === 'offer') {\n      // VERY limited support for SDP munging. Limited to:\n      // * changing the order of codecs\n      sections = SDPUtils.splitSections(description.sdp);\n      sessionpart = sections.shift();\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var caps = SDPUtils.parseRtpParameters(mediaSection);\n        pc.transceivers[sdpMLineIndex].localCapabilities = caps;\n      });\n\n      pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n        pc._gather(transceiver.mid, sdpMLineIndex);\n      });\n    } else if (description.type === 'answer') {\n      sections = SDPUtils.splitSections(pc._remoteDescription.sdp);\n      sessionpart = sections.shift();\n      var isIceLite = SDPUtils.matchPrefix(sessionpart,\n          'a=ice-lite').length > 0;\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        var iceGatherer = transceiver.iceGatherer;\n        var iceTransport = transceiver.iceTransport;\n        var dtlsTransport = transceiver.dtlsTransport;\n        var localCapabilities = transceiver.localCapabilities;\n        var remoteCapabilities = transceiver.remoteCapabilities;\n\n        // treat bundle-only as not-rejected.\n        var rejected = SDPUtils.isRejected(mediaSection) &&\n            SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n\n        if (!rejected && !transceiver.rejected) {\n          var remoteIceParameters = SDPUtils.getIceParameters(\n              mediaSection, sessionpart);\n          var remoteDtlsParameters = SDPUtils.getDtlsParameters(\n              mediaSection, sessionpart);\n          if (isIceLite) {\n            remoteDtlsParameters.role = 'server';\n          }\n\n          if (!pc.usingBundle || sdpMLineIndex === 0) {\n            pc._gather(transceiver.mid, sdpMLineIndex);\n            if (iceTransport.state === 'new') {\n              iceTransport.start(iceGatherer, remoteIceParameters,\n                  isIceLite ? 'controlling' : 'controlled');\n            }\n            if (dtlsTransport.state === 'new') {\n              dtlsTransport.start(remoteDtlsParameters);\n            }\n          }\n\n          // Calculate intersection of capabilities.\n          var params = getCommonCapabilities(localCapabilities,\n              remoteCapabilities);\n\n          // Start the RTCRtpSender. The RTCRtpReceiver for this\n          // transceiver has already been started in setRemoteDescription.\n          pc._transceive(transceiver,\n              params.codecs.length > 0,\n              false);\n        }\n      });\n    }\n\n    pc._localDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-local-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.setRemoteDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setRemoteDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set remote ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var streams = {};\n    pc.remoteStreams.forEach(function(stream) {\n      streams[stream.id] = stream;\n    });\n    var receiverList = [];\n    var sections = SDPUtils.splitSections(description.sdp);\n    var sessionpart = sections.shift();\n    var isIceLite = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-lite').length > 0;\n    var usingBundle = SDPUtils.matchPrefix(sessionpart,\n        'a=group:BUNDLE ').length > 0;\n    pc.usingBundle = usingBundle;\n    var iceOptions = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-options:')[0];\n    if (iceOptions) {\n      pc.canTrickleIceCandidates = iceOptions.substr(14).split(' ')\n          .indexOf('trickle') >= 0;\n    } else {\n      pc.canTrickleIceCandidates = false;\n    }\n\n    sections.forEach(function(mediaSection, sdpMLineIndex) {\n      var lines = SDPUtils.splitLines(mediaSection);\n      var kind = SDPUtils.getKind(mediaSection);\n      // treat bundle-only as not-rejected.\n      var rejected = SDPUtils.isRejected(mediaSection) &&\n          SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n      var protocol = lines[0].substr(2).split(' ')[2];\n\n      var direction = SDPUtils.getDirection(mediaSection, sessionpart);\n      var remoteMsid = SDPUtils.parseMsid(mediaSection);\n\n      var mid = SDPUtils.getMid(mediaSection) || SDPUtils.generateIdentifier();\n\n      // Reject datachannels which are not implemented yet.\n      if (rejected || (kind === 'application' && (protocol === 'DTLS/SCTP' ||\n          protocol === 'UDP/DTLS/SCTP'))) {\n        // TODO: this is dangerous in the case where a non-rejected m-line\n        //     becomes rejected.\n        pc.transceivers[sdpMLineIndex] = {\n          mid: mid,\n          kind: kind,\n          protocol: protocol,\n          rejected: true\n        };\n        return;\n      }\n\n      if (!rejected && pc.transceivers[sdpMLineIndex] &&\n          pc.transceivers[sdpMLineIndex].rejected) {\n        // recycle a rejected transceiver.\n        pc.transceivers[sdpMLineIndex] = pc._createTransceiver(kind, true);\n      }\n\n      var transceiver;\n      var iceGatherer;\n      var iceTransport;\n      var dtlsTransport;\n      var rtpReceiver;\n      var sendEncodingParameters;\n      var recvEncodingParameters;\n      var localCapabilities;\n\n      var track;\n      // FIXME: ensure the mediaSection has rtcp-mux set.\n      var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);\n      var remoteIceParameters;\n      var remoteDtlsParameters;\n      if (!rejected) {\n        remoteIceParameters = SDPUtils.getIceParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters.role = 'client';\n      }\n      recvEncodingParameters =\n          SDPUtils.parseRtpEncodingParameters(mediaSection);\n\n      var rtcpParameters = SDPUtils.parseRtcpParameters(mediaSection);\n\n      var isComplete = SDPUtils.matchPrefix(mediaSection,\n          'a=end-of-candidates', sessionpart).length > 0;\n      var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\n          .map(function(cand) {\n            return SDPUtils.parseCandidate(cand);\n          })\n          .filter(function(cand) {\n            return cand.component === 1;\n          });\n\n      // Check if we can use BUNDLE and dispose transports.\n      if ((description.type === 'offer' || description.type === 'answer') &&\n          !rejected && usingBundle && sdpMLineIndex > 0 &&\n          pc.transceivers[sdpMLineIndex]) {\n        pc._disposeIceAndDtlsTransports(sdpMLineIndex);\n        pc.transceivers[sdpMLineIndex].iceGatherer =\n            pc.transceivers[0].iceGatherer;\n        pc.transceivers[sdpMLineIndex].iceTransport =\n            pc.transceivers[0].iceTransport;\n        pc.transceivers[sdpMLineIndex].dtlsTransport =\n            pc.transceivers[0].dtlsTransport;\n        if (pc.transceivers[sdpMLineIndex].rtpSender) {\n          pc.transceivers[sdpMLineIndex].rtpSender.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n        if (pc.transceivers[sdpMLineIndex].rtpReceiver) {\n          pc.transceivers[sdpMLineIndex].rtpReceiver.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n      }\n      if (description.type === 'offer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex] ||\n            pc._createTransceiver(kind);\n        transceiver.mid = mid;\n\n        if (!transceiver.iceGatherer) {\n          transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n              usingBundle);\n        }\n\n        if (cands.length && transceiver.iceTransport.state === 'new') {\n          if (isComplete && (!usingBundle || sdpMLineIndex === 0)) {\n            transceiver.iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        localCapabilities = window.RTCRtpReceiver.getCapabilities(kind);\n\n        // filter RTX until additional stuff needed for RTX is implemented\n        // in adapter.js\n        if (edgeVersion < 15019) {\n          localCapabilities.codecs = localCapabilities.codecs.filter(\n              function(codec) {\n                return codec.name !== 'rtx';\n              });\n        }\n\n        sendEncodingParameters = transceiver.sendEncodingParameters || [{\n          ssrc: (2 * sdpMLineIndex + 2) * 1001\n        }];\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        var isNewTrack = false;\n        if (direction === 'sendrecv' || direction === 'sendonly') {\n          isNewTrack = !transceiver.rtpReceiver;\n          rtpReceiver = transceiver.rtpReceiver ||\n              new window.RTCRtpReceiver(transceiver.dtlsTransport, kind);\n\n          if (isNewTrack) {\n            var stream;\n            track = rtpReceiver.track;\n            // FIXME: does not work with Plan B.\n            if (remoteMsid && remoteMsid.stream === '-') {\n              // no-op. a stream id of '-' means: no associated stream.\n            } else if (remoteMsid) {\n              if (!streams[remoteMsid.stream]) {\n                streams[remoteMsid.stream] = new window.MediaStream();\n                Object.defineProperty(streams[remoteMsid.stream], 'id', {\n                  get: function() {\n                    return remoteMsid.stream;\n                  }\n                });\n              }\n              Object.defineProperty(track, 'id', {\n                get: function() {\n                  return remoteMsid.track;\n                }\n              });\n              stream = streams[remoteMsid.stream];\n            } else {\n              if (!streams.default) {\n                streams.default = new window.MediaStream();\n              }\n              stream = streams.default;\n            }\n            if (stream) {\n              addTrackToStreamAndFireEvent(track, stream);\n              transceiver.associatedRemoteMediaStreams.push(stream);\n            }\n            receiverList.push([track, rtpReceiver, stream]);\n          }\n        } else if (transceiver.rtpReceiver && transceiver.rtpReceiver.track) {\n          transceiver.associatedRemoteMediaStreams.forEach(function(s) {\n            var nativeTrack = s.getTracks().find(function(t) {\n              return t.id === transceiver.rtpReceiver.track.id;\n            });\n            if (nativeTrack) {\n              removeTrackFromStreamAndFireEvent(nativeTrack, s);\n            }\n          });\n          transceiver.associatedRemoteMediaStreams = [];\n        }\n\n        transceiver.localCapabilities = localCapabilities;\n        transceiver.remoteCapabilities = remoteCapabilities;\n        transceiver.rtpReceiver = rtpReceiver;\n        transceiver.rtcpParameters = rtcpParameters;\n        transceiver.sendEncodingParameters = sendEncodingParameters;\n        transceiver.recvEncodingParameters = recvEncodingParameters;\n\n        // Start the RTCRtpReceiver now. The RTPSender is started in\n        // setLocalDescription.\n        pc._transceive(pc.transceivers[sdpMLineIndex],\n            false,\n            isNewTrack);\n      } else if (description.type === 'answer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex];\n        iceGatherer = transceiver.iceGatherer;\n        iceTransport = transceiver.iceTransport;\n        dtlsTransport = transceiver.dtlsTransport;\n        rtpReceiver = transceiver.rtpReceiver;\n        sendEncodingParameters = transceiver.sendEncodingParameters;\n        localCapabilities = transceiver.localCapabilities;\n\n        pc.transceivers[sdpMLineIndex].recvEncodingParameters =\n            recvEncodingParameters;\n        pc.transceivers[sdpMLineIndex].remoteCapabilities =\n            remoteCapabilities;\n        pc.transceivers[sdpMLineIndex].rtcpParameters = rtcpParameters;\n\n        if (cands.length && iceTransport.state === 'new') {\n          if ((isIceLite || isComplete) &&\n              (!usingBundle || sdpMLineIndex === 0)) {\n            iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        if (!usingBundle || sdpMLineIndex === 0) {\n          if (iceTransport.state === 'new') {\n            iceTransport.start(iceGatherer, remoteIceParameters,\n                'controlling');\n          }\n          if (dtlsTransport.state === 'new') {\n            dtlsTransport.start(remoteDtlsParameters);\n          }\n        }\n\n        // If the offer contained RTX but the answer did not,\n        // remove RTX from sendEncodingParameters.\n        var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n        var hasRtx = commonCapabilities.codecs.filter(function(c) {\n          return c.name.toLowerCase() === 'rtx';\n        }).length;\n        if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n          delete transceiver.sendEncodingParameters[0].rtx;\n        }\n\n        pc._transceive(transceiver,\n            direction === 'sendrecv' || direction === 'recvonly',\n            direction === 'sendrecv' || direction === 'sendonly');\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        if (rtpReceiver &&\n            (direction === 'sendrecv' || direction === 'sendonly')) {\n          track = rtpReceiver.track;\n          if (remoteMsid) {\n            if (!streams[remoteMsid.stream]) {\n              streams[remoteMsid.stream] = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams[remoteMsid.stream]);\n            receiverList.push([track, rtpReceiver, streams[remoteMsid.stream]]);\n          } else {\n            if (!streams.default) {\n              streams.default = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams.default);\n            receiverList.push([track, rtpReceiver, streams.default]);\n          }\n        } else {\n          // FIXME: actually the receiver should be created later.\n          delete transceiver.rtpReceiver;\n        }\n      }\n    });\n\n    if (pc._dtlsRole === undefined) {\n      pc._dtlsRole = description.type === 'offer' ? 'active' : 'passive';\n    }\n\n    pc._remoteDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-remote-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n    Object.keys(streams).forEach(function(sid) {\n      var stream = streams[sid];\n      if (stream.getTracks().length) {\n        if (pc.remoteStreams.indexOf(stream) === -1) {\n          pc.remoteStreams.push(stream);\n          var event = new Event('addstream');\n          event.stream = stream;\n          window.setTimeout(function() {\n            pc._dispatchEvent('addstream', event);\n          });\n        }\n\n        receiverList.forEach(function(item) {\n          var track = item[0];\n          var receiver = item[1];\n          if (stream.id !== item[2].id) {\n            return;\n          }\n          fireAddTrack(pc, track, receiver, [stream]);\n        });\n      }\n    });\n    receiverList.forEach(function(item) {\n      if (item[2]) {\n        return;\n      }\n      fireAddTrack(pc, item[0], item[1], []);\n    });\n\n    // check whether addIceCandidate({}) was called within four seconds after\n    // setRemoteDescription.\n    window.setTimeout(function() {\n      if (!(pc && pc.transceivers)) {\n        return;\n      }\n      pc.transceivers.forEach(function(transceiver) {\n        if (transceiver.iceTransport &&\n            transceiver.iceTransport.state === 'new' &&\n            transceiver.iceTransport.getRemoteCandidates().length > 0) {\n          console.warn('Timeout for addRemoteCandidate. Consider sending ' +\n              'an end-of-candidates notification');\n          transceiver.iceTransport.addRemoteCandidate({});\n        }\n      });\n    }, 4000);\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.close = function() {\n    this.transceivers.forEach(function(transceiver) {\n      /* not yet\n      if (transceiver.iceGatherer) {\n        transceiver.iceGatherer.close();\n      }\n      */\n      if (transceiver.iceTransport) {\n        transceiver.iceTransport.stop();\n      }\n      if (transceiver.dtlsTransport) {\n        transceiver.dtlsTransport.stop();\n      }\n      if (transceiver.rtpSender) {\n        transceiver.rtpSender.stop();\n      }\n      if (transceiver.rtpReceiver) {\n        transceiver.rtpReceiver.stop();\n      }\n    });\n    // FIXME: clean up tracks, local streams, remote streams, etc\n    this._isClosed = true;\n    this._updateSignalingState('closed');\n  };\n\n  // Update the signaling state.\n  RTCPeerConnection.prototype._updateSignalingState = function(newState) {\n    this.signalingState = newState;\n    var event = new Event('signalingstatechange');\n    this._dispatchEvent('signalingstatechange', event);\n  };\n\n  // Determine whether to fire the negotiationneeded event.\n  RTCPeerConnection.prototype._maybeFireNegotiationNeeded = function() {\n    var pc = this;\n    if (this.signalingState !== 'stable' || this.needNegotiation === true) {\n      return;\n    }\n    this.needNegotiation = true;\n    window.setTimeout(function() {\n      if (pc.needNegotiation) {\n        pc.needNegotiation = false;\n        var event = new Event('negotiationneeded');\n        pc._dispatchEvent('negotiationneeded', event);\n      }\n    }, 0);\n  };\n\n  // Update the ice connection state.\n  RTCPeerConnection.prototype._updateIceConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      checking: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.iceTransport && !transceiver.rejected) {\n        states[transceiver.iceTransport.state]++;\n      }\n    });\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.checking > 0) {\n      newState = 'checking';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0) {\n      newState = 'connected';\n    } else if (states.completed > 0) {\n      newState = 'completed';\n    }\n\n    if (newState !== this.iceConnectionState) {\n      this.iceConnectionState = newState;\n      var event = new Event('iceconnectionstatechange');\n      this._dispatchEvent('iceconnectionstatechange', event);\n    }\n  };\n\n  // Update the connection state.\n  RTCPeerConnection.prototype._updateConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      connecting: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.iceTransport && transceiver.dtlsTransport &&\n          !transceiver.rejected) {\n        states[transceiver.iceTransport.state]++;\n        states[transceiver.dtlsTransport.state]++;\n      }\n    });\n    // ICETransport.completed and connected are the same for this purpose.\n    states.connected += states.completed;\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.connecting > 0) {\n      newState = 'connecting';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0) {\n      newState = 'connected';\n    }\n\n    if (newState !== this.connectionState) {\n      this.connectionState = newState;\n      var event = new Event('connectionstatechange');\n      this._dispatchEvent('connectionstatechange', event);\n    }\n  };\n\n  RTCPeerConnection.prototype.createOffer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createOffer after close'));\n    }\n\n    var numAudioTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'audio';\n    }).length;\n    var numVideoTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'video';\n    }).length;\n\n    // Determine number of audio and video tracks we need to send/recv.\n    var offerOptions = arguments[0];\n    if (offerOptions) {\n      // Reject Chrome legacy constraints.\n      if (offerOptions.mandatory || offerOptions.optional) {\n        throw new TypeError(\n            'Legacy mandatory/optional constraints not supported.');\n      }\n      if (offerOptions.offerToReceiveAudio !== undefined) {\n        if (offerOptions.offerToReceiveAudio === true) {\n          numAudioTracks = 1;\n        } else if (offerOptions.offerToReceiveAudio === false) {\n          numAudioTracks = 0;\n        } else {\n          numAudioTracks = offerOptions.offerToReceiveAudio;\n        }\n      }\n      if (offerOptions.offerToReceiveVideo !== undefined) {\n        if (offerOptions.offerToReceiveVideo === true) {\n          numVideoTracks = 1;\n        } else if (offerOptions.offerToReceiveVideo === false) {\n          numVideoTracks = 0;\n        } else {\n          numVideoTracks = offerOptions.offerToReceiveVideo;\n        }\n      }\n    }\n\n    pc.transceivers.forEach(function(transceiver) {\n      if (transceiver.kind === 'audio') {\n        numAudioTracks--;\n        if (numAudioTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      } else if (transceiver.kind === 'video') {\n        numVideoTracks--;\n        if (numVideoTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      }\n    });\n\n    // Create M-lines for recvonly streams.\n    while (numAudioTracks > 0 || numVideoTracks > 0) {\n      if (numAudioTracks > 0) {\n        pc._createTransceiver('audio');\n        numAudioTracks--;\n      }\n      if (numVideoTracks > 0) {\n        pc._createTransceiver('video');\n        numVideoTracks--;\n      }\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      // For each track, create an ice gatherer, ice transport,\n      // dtls transport, potentially rtpsender and rtpreceiver.\n      var track = transceiver.track;\n      var kind = transceiver.kind;\n      var mid = transceiver.mid || SDPUtils.generateIdentifier();\n      transceiver.mid = mid;\n\n      if (!transceiver.iceGatherer) {\n        transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n            pc.usingBundle);\n      }\n\n      var localCapabilities = window.RTCRtpSender.getCapabilities(kind);\n      // filter RTX until additional stuff needed for RTX is implemented\n      // in adapter.js\n      if (edgeVersion < 15019) {\n        localCapabilities.codecs = localCapabilities.codecs.filter(\n            function(codec) {\n              return codec.name !== 'rtx';\n            });\n      }\n      localCapabilities.codecs.forEach(function(codec) {\n        // work around https://bugs.chromium.org/p/webrtc/issues/detail?id=6552\n        // by adding level-asymmetry-allowed=1\n        if (codec.name === 'H264' &&\n            codec.parameters['level-asymmetry-allowed'] === undefined) {\n          codec.parameters['level-asymmetry-allowed'] = '1';\n        }\n\n        // for subsequent offers, we might have to re-use the payload\n        // type of the last offer.\n        if (transceiver.remoteCapabilities &&\n            transceiver.remoteCapabilities.codecs) {\n          transceiver.remoteCapabilities.codecs.forEach(function(remoteCodec) {\n            if (codec.name.toLowerCase() === remoteCodec.name.toLowerCase() &&\n                codec.clockRate === remoteCodec.clockRate) {\n              codec.preferredPayloadType = remoteCodec.payloadType;\n            }\n          });\n        }\n      });\n      localCapabilities.headerExtensions.forEach(function(hdrExt) {\n        var remoteExtensions = transceiver.remoteCapabilities &&\n            transceiver.remoteCapabilities.headerExtensions || [];\n        remoteExtensions.forEach(function(rHdrExt) {\n          if (hdrExt.uri === rHdrExt.uri) {\n            hdrExt.id = rHdrExt.id;\n          }\n        });\n      });\n\n      // generate an ssrc now, to be used later in rtpSender.send\n      var sendEncodingParameters = transceiver.sendEncodingParameters || [{\n        ssrc: (2 * sdpMLineIndex + 1) * 1001\n      }];\n      if (track) {\n        // add RTX\n        if (edgeVersion >= 15019 && kind === 'video' &&\n            !sendEncodingParameters[0].rtx) {\n          sendEncodingParameters[0].rtx = {\n            ssrc: sendEncodingParameters[0].ssrc + 1\n          };\n        }\n      }\n\n      if (transceiver.wantReceive) {\n        transceiver.rtpReceiver = new window.RTCRtpReceiver(\n            transceiver.dtlsTransport, kind);\n      }\n\n      transceiver.localCapabilities = localCapabilities;\n      transceiver.sendEncodingParameters = sendEncodingParameters;\n    });\n\n    // always offer BUNDLE and dispose on return if not supported.\n    if (pc._config.bundlePolicy !== 'max-compat') {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      sdp += writeMediaSection(transceiver, transceiver.localCapabilities,\n          'offer', transceiver.stream, pc._dtlsRole);\n      sdp += 'a=rtcp-rsize\\r\\n';\n\n      if (transceiver.iceGatherer && pc.iceGatheringState !== 'new' &&\n          (sdpMLineIndex === 0 || !pc.usingBundle)) {\n        transceiver.iceGatherer.getLocalCandidates().forEach(function(cand) {\n          cand.component = 1;\n          sdp += 'a=' + SDPUtils.writeCandidate(cand) + '\\r\\n';\n        });\n\n        if (transceiver.iceGatherer.state === 'completed') {\n          sdp += 'a=end-of-candidates\\r\\n';\n        }\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'offer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.createAnswer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createAnswer after close'));\n    }\n\n    if (!(pc.signalingState === 'have-remote-offer' ||\n        pc.signalingState === 'have-local-pranswer')) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createAnswer in signalingState ' + pc.signalingState));\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    if (pc.usingBundle) {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    var mediaSectionsInOffer = SDPUtils.getMediaSections(\n        pc._remoteDescription.sdp).length;\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      if (sdpMLineIndex + 1 > mediaSectionsInOffer) {\n        return;\n      }\n      if (transceiver.rejected) {\n        if (transceiver.kind === 'application') {\n          if (transceiver.protocol === 'DTLS/SCTP') { // legacy fmt\n            sdp += 'm=application 0 DTLS/SCTP 5000\\r\\n';\n          } else {\n            sdp += 'm=application 0 ' + transceiver.protocol +\n                ' webrtc-datachannel\\r\\n';\n          }\n        } else if (transceiver.kind === 'audio') {\n          sdp += 'm=audio 0 UDP/TLS/RTP/SAVPF 0\\r\\n' +\n              'a=rtpmap:0 PCMU/8000\\r\\n';\n        } else if (transceiver.kind === 'video') {\n          sdp += 'm=video 0 UDP/TLS/RTP/SAVPF 120\\r\\n' +\n              'a=rtpmap:120 VP8/90000\\r\\n';\n        }\n        sdp += 'c=IN IP4 0.0.0.0\\r\\n' +\n            'a=inactive\\r\\n' +\n            'a=mid:' + transceiver.mid + '\\r\\n';\n        return;\n      }\n\n      // FIXME: look at direction.\n      if (transceiver.stream) {\n        var localTrack;\n        if (transceiver.kind === 'audio') {\n          localTrack = transceiver.stream.getAudioTracks()[0];\n        } else if (transceiver.kind === 'video') {\n          localTrack = transceiver.stream.getVideoTracks()[0];\n        }\n        if (localTrack) {\n          // add RTX\n          if (edgeVersion >= 15019 && transceiver.kind === 'video' &&\n              !transceiver.sendEncodingParameters[0].rtx) {\n            transceiver.sendEncodingParameters[0].rtx = {\n              ssrc: transceiver.sendEncodingParameters[0].ssrc + 1\n            };\n          }\n        }\n      }\n\n      // Calculate intersection of capabilities.\n      var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n      var hasRtx = commonCapabilities.codecs.filter(function(c) {\n        return c.name.toLowerCase() === 'rtx';\n      }).length;\n      if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n        delete transceiver.sendEncodingParameters[0].rtx;\n      }\n\n      sdp += writeMediaSection(transceiver, commonCapabilities,\n          'answer', transceiver.stream, pc._dtlsRole);\n      if (transceiver.rtcpParameters &&\n          transceiver.rtcpParameters.reducedSize) {\n        sdp += 'a=rtcp-rsize\\r\\n';\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'answer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.addIceCandidate = function(candidate) {\n    var pc = this;\n    var sections;\n    if (candidate && !(candidate.sdpMLineIndex !== undefined ||\n        candidate.sdpMid)) {\n      return Promise.reject(new TypeError('sdpMLineIndex or sdpMid required'));\n    }\n\n    // TODO: needs to go into ops queue.\n    return new Promise(function(resolve, reject) {\n      if (!pc._remoteDescription) {\n        return reject(makeError('InvalidStateError',\n            'Can not add ICE candidate without a remote description'));\n      } else if (!candidate || candidate.candidate === '') {\n        for (var j = 0; j < pc.transceivers.length; j++) {\n          if (pc.transceivers[j].rejected) {\n            continue;\n          }\n          pc.transceivers[j].iceTransport.addRemoteCandidate({});\n          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n          sections[j] += 'a=end-of-candidates\\r\\n';\n          pc._remoteDescription.sdp =\n              SDPUtils.getDescription(pc._remoteDescription.sdp) +\n              sections.join('');\n          if (pc.usingBundle) {\n            break;\n          }\n        }\n      } else {\n        var sdpMLineIndex = candidate.sdpMLineIndex;\n        if (candidate.sdpMid) {\n          for (var i = 0; i < pc.transceivers.length; i++) {\n            if (pc.transceivers[i].mid === candidate.sdpMid) {\n              sdpMLineIndex = i;\n              break;\n            }\n          }\n        }\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        if (transceiver) {\n          if (transceiver.rejected) {\n            return resolve();\n          }\n          var cand = Object.keys(candidate.candidate).length > 0 ?\n              SDPUtils.parseCandidate(candidate.candidate) : {};\n          // Ignore Chrome's invalid candidates since Edge does not like them.\n          if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {\n            return resolve();\n          }\n          // Ignore RTCP candidates, we assume RTCP-MUX.\n          if (cand.component && cand.component !== 1) {\n            return resolve();\n          }\n          // when using bundle, avoid adding candidates to the wrong\n          // ice transport. And avoid adding candidates added in the SDP.\n          if (sdpMLineIndex === 0 || (sdpMLineIndex > 0 &&\n              transceiver.iceTransport !== pc.transceivers[0].iceTransport)) {\n            if (!maybeAddCandidate(transceiver.iceTransport, cand)) {\n              return reject(makeError('OperationError',\n                  'Can not add ICE candidate'));\n            }\n          }\n\n          // update the remoteDescription.\n          var candidateString = candidate.candidate.trim();\n          if (candidateString.indexOf('a=') === 0) {\n            candidateString = candidateString.substr(2);\n          }\n          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n          sections[sdpMLineIndex] += 'a=' +\n              (cand.type ? candidateString : 'end-of-candidates')\n              + '\\r\\n';\n          pc._remoteDescription.sdp =\n              SDPUtils.getDescription(pc._remoteDescription.sdp) +\n              sections.join('');\n        } else {\n          return reject(makeError('OperationError',\n              'Can not add ICE candidate'));\n        }\n      }\n      resolve();\n    });\n  };\n\n  RTCPeerConnection.prototype.getStats = function(selector) {\n    if (selector && selector instanceof window.MediaStreamTrack) {\n      var senderOrReceiver = null;\n      this.transceivers.forEach(function(transceiver) {\n        if (transceiver.rtpSender &&\n            transceiver.rtpSender.track === selector) {\n          senderOrReceiver = transceiver.rtpSender;\n        } else if (transceiver.rtpReceiver &&\n            transceiver.rtpReceiver.track === selector) {\n          senderOrReceiver = transceiver.rtpReceiver;\n        }\n      });\n      if (!senderOrReceiver) {\n        throw makeError('InvalidAccessError', 'Invalid selector.');\n      }\n      return senderOrReceiver.getStats();\n    }\n\n    var promises = [];\n    this.transceivers.forEach(function(transceiver) {\n      ['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',\n          'dtlsTransport'].forEach(function(method) {\n            if (transceiver[method]) {\n              promises.push(transceiver[method].getStats());\n            }\n          });\n    });\n    return Promise.all(promises).then(function(allStats) {\n      var results = new Map();\n      allStats.forEach(function(stats) {\n        stats.forEach(function(stat) {\n          results.set(stat.id, stat);\n        });\n      });\n      return results;\n    });\n  };\n\n  // fix low-level stat names and return Map instead of object.\n  var ortcObjects = ['RTCRtpSender', 'RTCRtpReceiver', 'RTCIceGatherer',\n    'RTCIceTransport', 'RTCDtlsTransport'];\n  ortcObjects.forEach(function(ortcObjectName) {\n    var obj = window[ortcObjectName];\n    if (obj && obj.prototype && obj.prototype.getStats) {\n      var nativeGetstats = obj.prototype.getStats;\n      obj.prototype.getStats = function() {\n        return nativeGetstats.apply(this)\n        .then(function(nativeStats) {\n          var mapStats = new Map();\n          Object.keys(nativeStats).forEach(function(id) {\n            nativeStats[id].type = fixStatsType(nativeStats[id]);\n            mapStats.set(id, nativeStats[id]);\n          });\n          return mapStats;\n        });\n      };\n    }\n  });\n\n  // legacy callback shims. Should be moved to adapter.js some days.\n  var methods = ['createOffer', 'createAnswer'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[0] === 'function' ||\n          typeof args[1] === 'function') { // legacy\n        return nativeMethod.apply(this, [arguments[2]])\n        .then(function(description) {\n          if (typeof args[0] === 'function') {\n            args[0].apply(null, [description]);\n          }\n        }, function(error) {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  methods = ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function' ||\n          typeof args[2] === 'function') { // legacy\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        }, function(error) {\n          if (typeof args[2] === 'function') {\n            args[2].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  // getStats is special. It doesn't have a spec legacy method yet we support\n  // getStats(something, cb) without error callbacks.\n  ['getStats'].forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function') {\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  return RTCPeerConnection;\n};\n\n},{\"sdp\":17}],17:[function(require,module,exports){\n /* eslint-env node */\n'use strict';\n\n// SDP helpers.\nvar SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substr(2, 10);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(function(line) {\n    return line.trim();\n  });\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  var parts = blob.split('\\nm=');\n  return parts.map(function(part, index) {\n    return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n  });\n};\n\n// returns the session description.\nSDPUtils.getDescription = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// returns the individual media sections.\nSDPUtils.getMediaSections = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(function(line) {\n    return line.indexOf(prefix) === 0;\n  });\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\nSDPUtils.parseCandidate = function(line) {\n  var parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  var candidate = {\n    foundation: parts[0],\n    component: parseInt(parts[1], 10),\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7]\n  };\n\n  for (var i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compability.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag\n        candidate[parts[i]] = parts[i + 1];\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\nSDPUtils.writeCandidate = function(candidate) {\n  var sdp = [];\n  sdp.push(candidate.foundation);\n  sdp.push(candidate.component);\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  var type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substr(14).split(' ');\n};\n\n// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  var parts = line.substr(9).split(' ');\n  var parsed = {\n    payloadType: parseInt(parts.shift(), 10) // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generate an a=rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  var channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1]\n  };\n};\n\n// Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n          ? '/' + headerExtension.direction\n          : '') +\n      ' ' + headerExtension.uri + '\\r\\n';\n};\n\n// Parses an ftmp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  var parsed = {};\n  var kv;\n  var parts = line.substr(line.indexOf(' ') + 1).split(';');\n  for (var j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  var line = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    var params = [];\n    Object.keys(codec.parameters).forEach(function(param) {\n      if (codec.parameters[param]) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' ')\n  };\n};\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  var lines = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(function(fb) {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses an RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  var sp = line.indexOf(' ');\n  var parts = {\n    ssrc: parseInt(line.substr(7, sp - 7), 10)\n  };\n  var colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substr(sp + 1, colon - sp - 1);\n    parts.value = line.substr(colon + 1);\n  } else {\n    parts.attribute = line.substr(sp + 1);\n  }\n  return parts;\n};\n\nSDPUtils.parseSsrcGroup = function(line) {\n  var parts = line.substr(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(function(ssrc) {\n      return parseInt(ssrc, 10);\n    })\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substr(6);\n  }\n};\n\nSDPUtils.parseFingerprint = function(line) {\n  var parts = line.substr(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1]\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n      'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role.\n  // Note2: 'algorithm' is not case sensitive except in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint)\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  var sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(function(fp) {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  // Search in session part, too.\n  lines = lines.concat(SDPUtils.splitLines(sessionpart));\n  var iceParameters = {\n    usernameFragment: lines.filter(function(line) {\n      return line.indexOf('a=ice-ufrag:') === 0;\n    })[0].substr(12),\n    password: lines.filter(function(line) {\n      return line.indexOf('a=ice-pwd:') === 0;\n    })[0].substr(10)\n  };\n  return iceParameters;\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  var description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: []\n  };\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    var pt = mline[i];\n    var rtpmapline = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      var codec = SDPUtils.parseRtpMap(rtpmapline);\n      var fmtps = SDPUtils.matchPrefix(\n          mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n          mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  var sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' UDP/TLS/RTP/SAVPF ';\n  sdp += caps.codecs.map(function(codec) {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(function(codec) {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  var maxptime = 0;\n  caps.codecs.forEach(function(codec) {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n  sdp += 'a=rtcp-mux\\r\\n';\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(function(extension) {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  var encodingParameters = [];\n  var description = SDPUtils.parseRtpParameters(mediaSection);\n  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(parts) {\n    return parts.attribute === 'cname';\n  });\n  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  var secondarySsrc;\n\n  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n  .map(function(line) {\n    var parts = line.substr(17).split(' ');\n    return parts.map(function(part) {\n      return parseInt(part, 10);\n    });\n  });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(function(codec) {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      var encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10)\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = {ssrc: secondarySsrc};\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(function(params) {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  var rtcpParameters = {};\n\n  // Gets the first SSRC. Note tha with RTX there might be multiple\n  // SSRCs.\n  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n      .map(function(line) {\n        return SDPUtils.parseSsrcMedia(line);\n      })\n      .filter(function(obj) {\n        return obj.attribute === 'cname';\n      })[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrіbute.\n  // Note that Edge does not support unmuxed RTCP.\n  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  var parts;\n  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substr(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(msidParts) {\n    return msidParts.attribute === 'msid';\n  });\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 21);\n};\n\n// Write boilder plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\n  var sessionId;\n  var version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  var user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=' + user + ' ' + sessionId + ' ' + version +\n        ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\nSDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.direction) {\n    sdp += 'a=' + transceiver.direction + '\\r\\n';\n  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + stream.id + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  var lines = SDPUtils.splitLines(mediaSection);\n  for (var i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substr(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return mline[0].substr(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var parts = lines[0].substr(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' ')\n  };\n};\n\nSDPUtils.parseOLine = function(mediaSection) {\n  var line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  var parts = line.substr(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5]\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function(blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  var lines = SDPUtils.splitLines(blob);\n  for (var i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n\n},{}]},{},[1])(1)\n});\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else {\n        window.location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}